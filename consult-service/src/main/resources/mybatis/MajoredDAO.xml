<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="cn.thinkjoy.gk.dao.IMajoredDAO">

    <select id="getMajoreByParentId" parameterType="java.lang.Integer" resultType="java.util.Map">
        select  id,name from gk_majored_category where 1=1
        and parentId=#{parentId}
    </select>

    <select id="searchMajored" parameterType="java.util.Map" resultType="SubjectDto">
        select a.id as majoredId,b.majoredName as name,b.enrollNumber as planNumber,
        b.schoolLength,b.foreignLanguage as foreginLanguage,b.feeStandard,b.universityId,b.universityName
        from gk_majored a  left join gk_enroll_plan  b  on a.id=b.majoredId  where 1=1
        <if test="condition.subjectTypeName!=null and condition.subjectTypeName!=''">
             and a.subjectType=#{condition.subjectTypeName}
        </if>
        <if test="condition.year!=null">
            and b.year=#{condition.year}
        </if>
        <if test="condition.majoredTypeName!=null and condition.majoredTypeName!=''">
            and a.majoredType=#{condition.majoredTypeName}
        </if>
        <if test="condition.searchName!=null and condition.searchName!=''">
            and b.majoredName like CONCAT('%',#{condition.searchName},'%')
        </if>
        <if test="condition.batchTypeName!=null and condition.batchTypeName!=''">
             and b.batch=#{condition.batchTypeName}
        </if>
        limit #{condition.pageNo},#{condition.pageSize}
    </select>

    <select id="searchMajoredCount" parameterType="java.util.Map" resultType="java.lang.Integer">
        select count(a.id) from gk_enroll_plan b left join gk_majored a on a.id=b.majoredId where 1=1
            <if test="condition.subjectTypeName!=null and condition.subjectTypeName!=''">
            and a.subjectType =#{condition.subjectTypeName}
        </if>
        <if test="condition.year!=null">
            and b.year=#{condition.year}
        </if>
        <if test="condition.majoredTypeName!=null and condition.majoredTypeName!=''">
            and a.majoredType=#{condition.majoredTypeName}
        </if>

        <if test="condition.searchName!=null and condition.searchName!=''">
            and b.majoredName like CONCAT('%',#{condition.searchName},'%')
        </if>
        <if test="condition.batchTypeName!=null and condition.batchTypeName!=''">
            and b.batch=#{condition.batchTypeName}
        </if>
    </select>

    <select id="getMajoredById" parameterType="java.lang.String" resultType="MajoredDto">
        select  id as majoredId, name,educationLevel,subjectType,majoredType,degree,similarMajored,mainCourse,workGuide
         from gk_majored where 1=1 and id=#{id}
    </select>


    <select id="getUniversityById" parameterType="java.lang.String" resultType="java.util.Map">
        select  id,name
        from gk_enroll_plan where 1=1 and batch=#{batchName} and majoredId=#{id}
    </select>


    <select id="getMajorDetailList" resultType="MajorDetailPojo">
        SELECT majoredId id,majoredName name,subject,schoolLength,feeStandard,enrollNumber planNum
    FROM gk_enroll_plan
    <where>
        1=1
        <if test="id!=null">
            and universityId = #{id}
        </if>
        <if test="batch!=null">
            and batch = #{batch}
        </if>
        <if test="year!=null">
            and year = #{year}
        </if>
    </where>
    </select>



</mapper>

