define(function(t){var a=t("$");t("swiper");var e={curPage:1,totalPage:0,render:function(t,a){var e=[],i=0,s=a.length;for(e.push('<a class="active" id="0">全部</a>');s>i;i++)e.push('<a id="'+a[i].id+'">'+a[i].name+"</a>");t.html(e.join(""))},show:function(t,e){this.render(a("#"+t),e),this.addEventForOption()},getData:function(){var t=this;a.get("/university/getInitInfo.do",function(e){"0000000"===e.rtnCode&&(a.each(["provinces","universityType","universityBatch","universityFeature"],function(a,i){t.show(i,e.bizData[i])}),t.getSchoolList(1))})},addEventForOption:function(){var t=this;a(".options a").on("click",function(e){a(this).hasClass("active")||(a(this).addClass("active").siblings().removeClass("active"),t.getSchoolList(1))})},renderSchool:function(t){var e=[],i=0,s=t.length;for(e.push('<table border="0" cellpadding="0" cellspacing="0"><thead><tr><th class="name">院校名称</th><th>所在地区</th><th>院校类型</th><th>院校隶属</th><th>院校特征</th><th>院校信息</th></tr></thead><tbody>');s>i;i++){var n=i%2!=0?"active":"";e.push('<tr class="'+n+'"><td class="name">'+t[i].name+"</td><td>"+t[i].provinceName+"</td><td>"+t[i].universityType+"</td><td>"+t[i].subjection+"</td><td>"+t[i].property+'</td><td><a href="/consult/school_detile.jsp?id='+t[i].code+'">查看详情</a></td></tr>')}e.push("</tbody></table>"),a("#school_list").html(e.join(""))},getSchoolList:function(t){var e=a("#provinces a.active").attr("id"),i=a("#provinces a.active").text();"全部"===i&&(i="");var s=a("#universityType a.active").attr("id"),n=a("#universityType a.active").text();"全部"===n&&(n="");var r=a("#universityBatch a.active").attr("id"),c=a("#universityBatch a.active").text();"全部"===c&&(c="");var o=a("#universityFeature a.active").attr("id"),h=a("#universityFeature a.active").text();"全部"===h&&(h="");var u=a("#school_serach").val(),v=this;a.ajax({type:"post",url:"/university/getUniversityList.do",contentType:"application/x-www-form-urlencoded;charset=utf-8",data:{provinceId:e,provinceName:i,universityTypeId:s,universityTypeName:n,universityBatchId:r,universityBatchName:c,universityFeatureId:o,universityFeatureName:h,pageSize:10,pageNo:t,searchName:u},dataType:"json",success:function(a){if("0000000"===a.rtnCode){var e=a.bizData.schoolList;v.renderSchool(e),1==t&&v.renderPage(1,a.bizData.schoolCount)}},error:function(t){}})},renderPage:function(t,e){this.totalPage=Math.ceil(e/10);var i=[],s=10*(t-1)+1;i.push('<span class="record">共'+e+'条记录 <span class="startNum">'+s+"</span>/"+e+"</span>"),i.push('<a class="previous-page">上一页</a>');for(var n=0;n<this.totalPage;n++){var r=n+1;t==r?i.push('<a class="active">'+r+"</a>"):i.push("<a>"+r+"</a>")}i.push('<a class="next-page">下一页</a>'),a("#page").html(i.join("")),this.pageEventHandle()},pageEventHandle:function(){var t=this;a("#page a").on("click",function(e){if(!a(this).hasClass("active")&&(a(this).addClass("active").siblings().removeClass("active"),a(this).hasClass("previous-page")?t.curPage--:a(this).hasClass("next-page")?t.curPage++:t.curPage=parseInt(a(this).text()),t.curPage>0&&t.curPage<=t.totalPage)){var i=10*(t.curPage-1)+1;a(".startNum").text(i),t.getSchoolList(t.curPage)}})},getSearch:function(){this.curPage=1,this.getSchoolList(1)}};a(document).ready(function(){e.getData(),a("#search_button").on("click",function(t){var i=a("#school_serach").val();i&&e.getSearch()})})});