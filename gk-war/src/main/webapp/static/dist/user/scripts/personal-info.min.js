define(function(t){function e(t){var e=new Date;return e.setTime(t),e.Format("yyyy-MM-dd")}t("laydate"),Date.prototype.Format=function(t){var e={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length)));for(var a in e)new RegExp("("+a+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?e[a]:("00"+e[a]).substr((""+e[a]).length)));return t},$.get("/vip/getAccount.do",function(t){$(".account-tel").text(t.bizData.account)}),$.get("/info/getUserInfo.do",function(t){if("0000000"==t.rtnCode){var a,n=t.bizData;a=""==n.icon||null==n.icon?"/static/dist/common/images/icon_default.png":n.icon,console.log(t),$(".avatar-img").attr("src",a),$(".avatar-box").show(),$(".name").attr("value",n.name),$(".school").attr("value",n.schoolName),$(".birthdayDate").attr("value",e(n.birthdayDate)),$(".sex").attr("value",n.sex),$(".subject").attr("value",n.subjectType),$(".mail").attr("value",n.mail),$(".qq").attr("value",n.qq),$("#cmbProvince option").attr("value",n.provinceId),$("#cmbCity option").attr("value",n.cityId),$("#cmbArea option").attr("value",n.countyId),1==n.sex?$("#sex_m").attr("checked",!0):$("#sex_w").attr("checked",!0),1==n.subjectType?$("#subject_l").attr("checked",!0):$("#subject_w").attr("checked",!0)}else alert(t.msg)}),$(".content").fadeIn();var a="";$.ajax({url:"/region/getAllRegion.do",dataType:"json",type:"get",data:{},success:function(t){if("0000000"==t.rtnCode){var e=t.bizData;console.info(e[0].cityList[0].name),console.info(e[0].cityList[0].id),console.info(e[0].cityList[0].provinceId),$.each(e,function(t,e){a+='<option value="'+t+'">'+e.name+"</option>",console.log(e)}),console.log(a),$("#cmbProvince").html(a)}}}),$("#cmbProvince").onchange(function(){alert(1)}),setTimeout(function(){var t=["-100","-110","-120","-130"],e=["文件数量不能超过(5)","文件超过大小限制(10MB)","零字节的文件","无效的文件类型"];$("#uploadify").uploadify({swf:"/static/bower_components/uploadify/uploadify.swf",fileObjName:"file",uploader:"http://pre.file.xy189.cn/file/upload/savefile.shtml",auto:!0,removeTimeout:0,multi:!1,uploadLimit:0,fileSizeLimit:"10MB",fileTypeDesc:"图片文件(*.jpg;*.png;*.gif;*.jpeg)",buttonText:"点击上传",fileTypeExts:"*.jpg;*.png;*.gif;*.jpeg",progressData:"percentage",speed:"percentage",queueSizeLimit:5,removeCompleted:!0,onSelect:function(t){this.queueData.filesErrored=0},onOpen:function(t,e,a){},onSelectError:function(a,n,o){for(var i=0;i<t.length;i++)t[i]==n&&(this.queueData.errorMsg=e[i])},onCancel:function(t){},onFallback:function(){alert("浏览器不能兼容Flash,请下载最新版!")},onClearQueue:function(t){},onUploadStart:function(t){},onUploadSuccess:function(t,e,a){console.log(e);var n=JSON.parse(e),e={userIcon:n.data.url};$(".avatar-img").attr("src",n.data.url);var o=this.wrapper.selector;$(o).uploadify("settings","buttonText","正在加载"),$("img[data-icon]").each(function(){$(this).attr("src",n.data.url+"!100?t="+(new Date).getTime())}),$(o).uploadify("settings","buttonText","换一个")},onUploadError:function(t,e,a,n){switch(a){case"400":$("#"+t.id).find(".data").html(" - 上传失败，文件超过大小限制(2MB)");break;case"401":$("#"+t.id).find(".data").html(" - 上传失败，零字节的文件");break;case"402":$("#"+t.id).find(".data").html(" - 上传失败，无效的文件类型");break;case"500":$("#"+t.id).find(".data").html(" - 上传失败，服务器问题")}},onDialogClose:function(t){}})},10),$(".btn-submit").click(function(){var t=$('input[name="sex"]:checked').val(),e=$('input[name="subject"]:checked').val(),a=$(".school").val(),n=$(".birthdayDate").val(),o=Date.parse(new Date(n))/1e3,i=$(".name").val().trim();if(i.length>10)return $(".error-tips").text("用户名不能大于10个字").fadeIn(),!1;var r=$(".mail").val().trim(),c=/^([a-zA-Z0-9]+[_|\_|\.]?)*[a-zA-Z0-9]+@([a-zA-Z0-9]+[_|\_|\.]?)*[a-zA-Z0-9]+\.[a-zA-Z]{2,3}$/;if(!c.test(r))return $(".error-tips").text("邮箱填写有误").fadeIn(),!1;var s=/^\s*[.0-9]{5,11}\s*$/,l=$(".qq").val().trim();if(!s.test(l))return $(".error-tips").text("QQ号码输入有误").fadeIn(),!1;var u=$(".avatar-img ").attr("src");$.ajax({url:"/info/updateUserInfo.do",dataType:"json",type:"post",data:{name:i,provinceId:"610000",cityId:"610800",countyId:"610802",schoolName:a,sex:t,birthdayDate:o,subjectType:e,mail:r,icon:u,qq:l},success:function(t){"0000000"==t.rtnCode?($(".user-avatar").attr("src",u),$(".error-tips").text("信息更新成功").fadeIn(1e3).fadeOut(2e3)):$(".content").text(t.msg)}})})});