define(function(t){function e(t){var e=new Date;return e.setTime(t),e.Format("yyyy-MM-dd")}var a=t("$");t("header-user"),t("laydate"),Date.prototype.Format=function(t){var e={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length)));for(var a in e)new RegExp("("+a+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?e[a]:("00"+e[a]).substr((""+e[a]).length)));return t},a.get("/vip/getAccount.do",function(t){a(".account-tel").text(t.bizData.account)}),a.get("/info/getUserInfo.do",function(t){if("0000000"==t.rtnCode){var o=t.bizData;console.log(o);var n;n=""==o.icon||null==o.icon?"/static/dist/common/images/icon_default.png":o.icon,a(".avatar-img").attr("src",n),a(".avatar-box").show(),a(".name").attr("value",o.name),a(".school").attr("value",o.schoolName),a(".birthdayDate").attr("value",e(o.birthdayDate)),a(".sex").attr("value",o.sex),a(".subject").attr("value",o.subjectType),a(".mail").attr("value",o.mail),a(".qq").attr("value",o.qq),1==o.sex&&a("#sex_m").attr("checked",!0),1==o.subjectType&&a("#subject_w").attr("checked",!0)}else alert(t.msg)}),a.ajax({url:"/region/getAllRegion.do",dataType:"json",type:"get",data:{},success:function(t){console.log(t)}}),a(".content").fadeIn(),setTimeout(function(){var t=["-100","-110","-120","-130"],e=["文件数量不能超过(5)","文件超过大小限制(10MB)","零字节的文件","无效的文件类型"];a("#uploadify").uploadify({swf:"/static/bower_components/uploadify/uploadify.swf",fileObjName:"file",uploader:"http://pre.file.xy189.cn/file/upload/savefile.shtml",auto:!0,removeTimeout:0,multi:!1,uploadLimit:0,fileSizeLimit:"10MB",fileTypeDesc:"图片文件(*.jpg;*.png;*.gif;*.jpeg)",buttonText:"点击上传",fileTypeExts:"*.jpg;*.png;*.gif;*.jpeg",progressData:"percentage",speed:"percentage",queueSizeLimit:5,removeCompleted:!0,onSelect:function(t){this.queueData.filesErrored=0},onOpen:function(t,e,a){},onSelectError:function(a,o,n){for(var i=0;i<t.length;i++)t[i]==o&&(this.queueData.errorMsg=e[i])},onCancel:function(t){},onFallback:function(){alert("浏览器不能兼容Flash,请下载最新版!")},onClearQueue:function(t){},onUploadStart:function(t){},onUploadSuccess:function(t,e,o){console.log(e);var n=JSON.parse(e),e={userIcon:n.data.url};a.ajax({type:"post",url:"/expert/updateUser.do",dataType:"json",data:e,async:!1,success:function(t){"0000000"!==t.rtnCode?alert(t.msg):(console.log(t),a(".expert-avatar").find(".tips").html("更新成功").fadeOut(5e3))}}),a(".user-icon").attr("src",n.data.url);var i=this.wrapper.selector;a(i).uploadify("settings","buttonText","正在加载"),a("img[data-icon]").each(function(){a(this).attr("src",n.data.url+"!100?t="+(new Date).getTime())}),a(i).uploadify("settings","buttonText","重新上传")},onUploadError:function(t,e,o,n){switch(o){case"400":a("#"+t.id).find(".data").html(" - 上传失败，文件超过大小限制(2MB)");break;case"401":a("#"+t.id).find(".data").html(" - 上传失败，零字节的文件");break;case"402":a("#"+t.id).find(".data").html(" - 上传失败，无效的文件类型");break;case"500":a("#"+t.id).find(".data").html(" - 上传失败，服务器问题")}},onDialogClose:function(t){}})},10);a(".name").val(),a(".school").val(),a(".birthdayDate").val();a(".btn-submit").click(function(){a.ajax({url:"/info/updateUserInfo.do",dataType:"json",type:"post",data:{name:"韩小寒",countyId:"2",schoolName:"苏州中学",sex:"1",birthdayDate:"1443001519852",subjectType:"1",mail:"12345678@qq.com",icon:"http://img1.2345.com/duoteimg/qqTxImg/2013/12/ka_3/04-054658_103.jpg",qq:"123456"}})})});