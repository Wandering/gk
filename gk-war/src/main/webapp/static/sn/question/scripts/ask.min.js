define(function(e){function o(e,o){var t=new RegExp(o?e+"=(?:.*?&)*?"+o+"=([^&;$]*)":e+"=([^;$]*)","i");return t.test(unescape(document.cookie))?RegExp.$1:""}function t(e){var o=new RegExp("(^|\\?|&)"+e+"=([^&]*)(\\s|&|$)","i");return o.test(window.location.href)?unescape(RegExp.$2.replace(/\+/g," ")):""}function n(){var e=r("#content").val();if(!e)return r("#error").show().html("内容不能为空！"),void setTimeout(function(){r("#error").hide()},2e3);var o=i.text().replace(/<[^>]+>/gi,"");if(!o)return r("#error").show().html("请输入问题描述！"),void setTimeout(function(){r("#error").hide()},2e3);var n=!1;n||(n=!0,r.ajax({type:"post",url:"/question/insert.do",contentType:"application/x-www-form-urlencoded;charset=utf-8",data:{question:e},dataType:"json",success:function(e){if(n=!1,"0000000"===e.rtnCode){i.html(""),r("#custom_body").html('<p class="error-contnet">提交成功！</p>'),r("#custom_model").fadeIn(500),r("#custom_model").off("click"),r("#custom_model").on("model_buttonclick",function(e){e.stopPropagation()}),r("#model_button").off("click"),r("#model_button").on("click",function(e){r("#custom_model").fadeOut(500)});var o=t("path");console.log(o),"online"===o&&(window.location.href="/user/online-answer.jsp?method=ask")}else r("#error").show().html(e.msg);"1000004"===e.rtnCode&&(r("#error_tip").html(e.msg+",请<a target='_blank' href='/login/login.jsp'>登录</a>"),r("#error_tip").show())},error:function(e){n=!1,r("#error").show().html("服务器错误。")}}))}o("gkuser")&&'""'!=o("gkuser")||(window.location.href="/login/login.jsp");var r=e("$");e("header-user"),e("swiper");var i;KindEditor.ready(function(e){var o=window.location,t=o.protocol+"//"+o.host+"/question/proxy.html";i=e.create('textarea[name="content"]',{resizeType:1,allowImageRemote:!1,formatUploadUrl:!1,uploadJson:"http://10.21.67.8:8080/file/upload/saveiframefile.shtml?redirectPath="+t,filePostName:"file",allowPreviewEmoticons:!1,allowFileManager:!1,items:["plainpaste","insertorderedlist","insertunorderedlist","forecolor","hilitecolor","bold","italic","underline","|","image","fullscreen"],afterBlur:function(){this.sync()},afterChange:function(){},afterUpload:function(e){console.log(e)}})}),r(document).ready(function(){r("#submit_question").on("click",function(e){n()})})});