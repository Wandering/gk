define(function(t){var e=t("$"),s=function(t,e){var s,n=new RegExp("(^|)"+e+"=([^&]*)(&|$)","g").exec(t);return(s=n)?s[2]:""},n={startSize:0,endSize:10,renderAsk:function(t){for(var s=[],n=0,a=t.length;a>n;n++){var i=t[n].question;if(i){s.push('<a href="/question/question_detail.jsp?id='+i.questionId+'"><section class="ask-answer mt20">'),s.push('<div class="ask mt20">'),s.push('<div class="head-img">');var o=i.userIcon||"http://cdn.gaokao360.net/static/global/common/images/user_default.png";"aa.jpg".match(/(.jpg|.png|.gif)/g)||(o="http://cdn.gaokao360.net/static/global/common/images/user_default.png"),s.push('<img src="'+(o||"")+'" />'),s.push("</div>"),s.push('<div class="head-info">');var r=new Date(i.createTime).Format("yyyy-MM-dd hh:mm");s.push("<h6>来自 "+(i.userName||"")+r+"</h6>");for(var h=i.questions,u=[],d=0,c=h.length;c>d;d++)u.push(h[d].text);var l=u.join("");l.length>200&&(l=l.substring(0,200)+"..."),s.push("<h3>"+l+"</h3>"),s.push("</div></div>")}var g=t[n].answer;g&&s.push(this.renderAnswer(g)),s.push("</section></a>")}0==this.startSize?e("#question_content").html(s.join("")):e("#question_content").append(s.join(""))},renderAnswer:function(t){var e=[];e.push('<ul class="answer-list">'),e.push("<li>"),e.push('<div class="left">'),e.push('<div class="head-img">'),e.push('<img src="'+(t.userIcon||"/static/src/common/images/user_default.png")+'" />'),e.push('<i class="star"></i>'),e.push("</div>"),e.push("<span>"+(t.userName||"")+"</span>"),e.push("</div>");for(var s=t.answers,n=[],a=0,i=s.length;i>a;a++)n.push("<p>"+s[a].text+"</p>"),s[a].img&&n.push('<p class="ta"><img src="'+s[a].img+'" /></p>');var o=n.join("");return o.length>200&&(o=o.substring(0,200)+"..."),e.push('<div class="right">'+o+"</div>"),e.push("</li></ul>"),e.join("")},getNew:function(){var t="/question/newQuestion.do?";this.getData(t)},getHot:function(){var t="/question/hotQuestion.do?";this.getData(t)},getData:function(t){0==this.startSize&&(e(".next-btn").removeClass("none"),e(".next-btn").text("加载更多..."));var s=this;e.get(t+"startSize="+s.startSize+"&endSize="+s.endSize,function(t){"0000000"===t.rtnCode&&(console.log(t.bizData.length),t.bizData.length>0?(e("#more_loading").show(),s.renderAsk(t.bizData)):0==s.startSize?(e("#more_loading").hide(),e("#question_content").html('<p style="padding: 20px 0;text-align: center">暂无相关信息！</p>')):(e(".next-btn").text("暂无更多信息！"),e(".next-btn").addClass("none")))})},getSearch:function(){var t=e("#keywords").val();e("#tabs_list").hide(),this.startSize=0,this.endSize=10;var s="/question/newQuestion.do?keyword="+t+"&";this.getData(s)},addEventForMore:function(){this.startSize+=10,this.endSize+=10;var t=e("#keywords").val();if(t){var s="/question/newQuestion.do?keyword="+t+"&";this.getData(s)}else n[e(".tabs-list li.active").attr("data-method")]()}};e(document).ready(function(){var t=decodeURIComponent(s(window.location.href,"val"));t?(e("#tabs_list").hide(),e("#keywords").val(t),n.getSearch()):(e("#tabs_list").show(),n.getNew(),e(".tabs-list li").on("mouseover",function(t){e(this).hasClass("active")||(e(this).addClass("active").siblings().removeClass("active"),n.startSize=0,n.endSize=10,n[e(this).attr("data-method")]())})),e("#search").on("click",function(t){n.getSearch()}),e(".next-btn").on("click",function(t){e(this).hasClass("none")||n.addEventForMore()})})});