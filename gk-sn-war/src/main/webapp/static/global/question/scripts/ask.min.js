define(function(e){function o(e){var o=new RegExp("(^|\\?|&)"+e+"=([^&]*)(\\s|&|$)","i");return o.test(window.location.href)?unescape(RegExp.$2.replace(/\+/g," ")):""}function t(){var e=n("#content").val();if(!e)return n("#error").show().html("内容不能为空！"),void setTimeout(function(){n("#error").hide()},2e3);var t=r.text().replace(/<[^>]+>/gi,"");if(!t)return n("#error").show().html("请输入问题描述！"),void setTimeout(function(){n("#error").hide()},2e3);var i=!1;i||(i=!0,n.ajax({type:"post",url:"/question/insert.do",contentType:"application/x-www-form-urlencoded;charset=utf-8",data:{question:e},dataType:"json",success:function(e){if(i=!1,"0000000"===e.rtnCode){r.html(""),n("#custom_body").html('<p class="error-contnet">提交成功！</p>'),n("#custom_model").fadeIn(500),n("#custom_model").off("click"),n("#custom_model").on("model_buttonclick",function(e){e.stopPropagation()}),n("#model_button").off("click"),n("#model_button").on("click",function(e){n("#custom_model").fadeOut(500)});var t=o("path");console.log(t),"online"===t&&(window.location.href="/user/online-answer.jsp?method=ask")}else n("#error").show().html(e.msg);"1000004"===e.rtnCode&&(n("#error_tip").html(e.msg+",请<a target='_blank' href='/login/login.jsp'>登录</a>"),n("#error_tip").show())},error:function(e){i=!1,n("#error").show().html("服务器错误。")}}))}var n=e("$");e("header-user");var r;KindEditor.ready(function(e){var o=window.location,t=o.protocol+"//"+o.host+"/question/proxy.html";r=e.create('textarea[name="content"]',{resizeType:1,allowImageRemote:!1,formatUploadUrl:!1,uploadJson:"http://10.21.67.8:8080/file/upload/saveiframefile.shtml?redirectPath="+t,filePostName:"file",allowPreviewEmoticons:!1,allowFileManager:!1,items:["plainpaste","insertorderedlist","insertunorderedlist","forecolor","hilitecolor","bold","italic","underline","|","image","fullscreen"],afterBlur:function(){this.sync()},afterChange:function(){},afterUpload:function(e){console.log(e)}})}),n(document).ready(function(){n("#submit_question").on("click",function(e){t()})})});