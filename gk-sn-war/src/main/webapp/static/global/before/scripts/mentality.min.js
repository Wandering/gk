define(function(e){function t(){a.getJSON("/before/video/getSubjectList.do",function(e){if("0000000"==e.rtnCode)for(var t=e.bizData,s=0;s<t.length;s++){var n=t[s].subjectName,o=t[s].subjectId,i='<option value="'+o+'">'+n+"</option>";a(".subjectList").append(i)}})}function s(e,t,s,o,i){a.getJSON("/before/video/getVideoList.do",{pageNo:e,pageSize:t,classifyType:2,sortType:s,subjectId:o,searchName:i},function(s){if(console.log(s),"0800001"==s.rtnCode&&(n.$listMsgItem.append('<p class="noContent">'+s.msg+"</p>"),n.$nextPage.hide()),"0000000"==s.rtnCode){var a=s.bizData;console.log(a),a.length>0&&n.$nextPage.show();for(var o=0;o<a.length;o++){var i=a[o].title,l=a[o].teacherName,c=a[o].courseId,r=a[o].hit,g=a[o].subcontent,d="/before/teacher-lecture-play.jsp?classifyType=2&courseId="+c,p="";p=null==a[o].frontCover||""==a[o].frontCover?"/static/dist/common/images/video-default.png":a[o].frontCover;var f=g;f.length>150&&(f=f.substring(0,150)+"...");var v='<li class="item"><div class="img"><img src="'+p+'" alt=""/></div><div class="info"><span class="fl">课程名称:'+i+'</span><span class="fr">主讲专家:'+l+'</span></div><div class="num"><span class="fl">点击量:'+r+'</span></div><p class="txt">'+f+'</p><div class="funs"><a target="_blank" href="'+d+'" class="btn">点击播放</a></div></li>';n.$listMsgItem.append(v)}e++,n.$listMsgItem.attr("pageNo",e),a.length<t&&n.$nextPage.hide()}})}var a=e("$");e("backToTop");var n={$listMsgItem:a("#list-msg-item"),$nextPage:a("#nextPage")},o=4,i=decodeURIComponent(window.location.search),l=i.substr(14,1),c=i.indexOf("&"),r=i.substr(c+9);console.log(l),console.log(r),a("#searchVal").val(r),a("#search-btn").on("click",function(){window.location.href="/before/mentality.jsp?classifyType=2&searchV="+encodeURIComponent(a("#searchVal").val())}),t();var g=a("#searchVal").val();n.$nextPage.on("click",function(){var e=n.$listMsgItem.attr("pageNo");s(e,o,1,"",g)}).click(),a(".subjectList").change(function(){var e=a(this).find("option:selected").attr("value"),t=a(".subject-fun").find("option:selected").attr("value");n.$listMsgItem.attr("pageNo",0);var i=n.$listMsgItem.attr("pageNo");n.$listMsgItem.html(""),s(i,o,t,e,"")}),a(".subject-fun").change(function(){var e=a(this).find("option:selected").attr("value"),t=a(".subjectList").find("option:selected").attr("value");n.$listMsgItem.attr("pageNo",0);var i=n.$listMsgItem.attr("pageNo");n.$listMsgItem.html(""),s(i,o,e,t,"")})});