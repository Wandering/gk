define(function(e){function t(){n.getJSON("/before/video/getSubjectList.do",function(e){if("0000000"==e.rtnCode)for(var t=e.bizData,a=0;a<t.length;a++){var s=t[a].subjectName,o=t[a].subjectId,i='<option value="'+o+'">'+s+"</option>";n(".subjectList").append(i)}})}function a(){n.ajax({url:"/vip/getAccount.do",type:"GET",dataType:"JSON",success:function(e){console.log(e);if("0000000"==e.rtnCode){var t=e.bizData.vipStatus;0==t&&n(".years-fun").append('<option value="2014">2014年</option><option value="2013">2013年</option>'),1==t&&n(".years-fun").append('<option value="2015">2015年(vip用户专享)</option><option value="2014">2014年</option><option value="2013">2013年</option>')}}})}function s(e,t,a,s,c){n.getJSON("/before/paper/getPaperList.do",{pageNo:e,pageSize:t,sortType:1,years:s,subjectId:a,searchName:c},function(a){if(console.log(a),("0800001"==a.rtnCode||"1000004"==a.rtnCode)&&(o.$listMsgItem.append('<p class="noContent">'+a.msg+"</p>"),o.$nextPage.hide()),"0000000"==a.rtnCode){var s=a.bizData;s.length>0&&o.$nextPage.show();for(var n=0;n<s.length;n++){var c=s[n].paperName,r=s[n].createDate,l=s[n].subjectId,p=s[n].resources,g="";switch(l){case 1:g="语文";break;case 2:g="数学";break;case 3:g="英语";break;case 10:g="理综";break;case 11:g="文综";break;default:g="其他"}var u='<li class="item"><a target="_blank" href="/before/exam-play.jsp?url='+i+p+'"><span class="subject-n"><strong>'+g+'</strong></span><span class="subject-t">'+c+'</span><span class="subject-d">上传时间：'+getTime(r)+"</span></a></li>";o.$listMsgItem.append(u)}e++,o.$listMsgItem.attr("pageNo",e),s.length<t&&o.$nextPage.hide()}})}var n=e("$");e("backToTop"),e("getTime");var o={$listMsgItem:n("#list-msg-item"),$nextPage:n("#nextPage")},i="http://www.gkzy114.com",c=decodeURIComponent(window.location.search),r=(c.substr(14,1),c.indexOf("&")),l=c.substr(r+9);n("#searchVal").val(l),n("#search-btn").on("click",function(){window.location.href="/before/exam.jsp?classifyType=3&searchV="+n("#searchVal").val()}),t(),a();var p=8,g=n("#searchVal").val();o.$nextPage.on("click",function(){var e=o.$listMsgItem.attr("pageNo"),t=n(".subjectList").find("option:checked").val();console.log(t),n.ajax({url:"/vip/getAccount.do",type:"GET",dataType:"JSON",success:function(a){if(console.log(a),"1000004"==a.rtnCode&&(o.$listMsgItem.append('<p class="noContent">'+a.msg+"</p>"),o.$nextPage.hide()),"0000000"==a.rtnCode){var n=a.bizData.vipStatus;0==n&&s(e,p,t,"2014",g),1==n&&s(e,p,t,"2015",g)}}})}).click(),n(".subjectList").change(function(){var e=n(this).find("option:selected").attr("value"),t=n(".years-fun").find("option:selected").attr("value");o.$listMsgItem.attr("pageNo",0);var a=o.$listMsgItem.attr("pageNo");o.$listMsgItem.html(""),s(a,p,e,t,""),n("#searchVal").val("")}),n(".years-fun").change(function(){var e=n(this).find("option:selected").attr("value"),t=n(".subjectList").find("option:selected").attr("value");o.$listMsgItem.attr("pageNo",0);var a=o.$listMsgItem.attr("pageNo");o.$listMsgItem.html(""),s(a,p,t,e,""),n("#searchVal").val("")})});