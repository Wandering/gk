define(function(t){var e=t("$");t("backToTop"),e(function(){function t(t,a,n){t.m_province=a,t.m_specialty_name=n,e.ajax({url:"/guide/school.do",type:"GET",dataType:"JSON",data:t,success:function(t){if("0100006"==t.rtnCode||"1000004"==t.rtnCode||"0100005"==t.rtnCode)return void e(".error-tips").text(t.msg).fadeIn(1e3).fadeOut(1e3);if("0000000"==t.rtnCode){var a=e.parseJSON(t.bizData),n=a.related.m_batch_id,i=a.related.m_batch,o=a.data.result;0==o.data.length&&(e(".no-school").show(),e(".school-list").hide());var r="";"文史"==a.related.m_kelei?r=0:"理工"==a.related.m_kelei&&(r=1);var l=e("#volunteer-flow3-layer").attr("datatype");e(".school-list").html(""),e.each(o.data,function(t,a){o.data[t].data.length>0&&4>t?(e("#no-school"+t).hide(),e("#school-list"+t).show(),e.each(o.data[t].data,function(a,o){var c='<div><span class="fl"><a target="_blank" href="/consult/school_detail.jsp?code='+o.m_university_code+"&batch="+n+'" id="'+o.m_university_code+'">'+o.m_university_name+'</a></span><span class="fr selSchool" datatypeId="'+l+'" m_university_name="'+o.m_university_name+'" id="'+o.m_university_code+'" type = "'+r+'" m_batch_id="'+n+'" m_batch="'+i+'">选择</span></div>';e("#school-list"+t).append(c)})):(e("#no-school"+t).show(),e("#school-list"+t).hide())})}}})}var a=JSON.parse(params);console.log(a),e(".volunteer-flow3-table").on("click",".open-flow3",function(){e(".tansLayer,.volunteer-flow3-layer").show(),e("#volunteer-flow3-layer").attr("dataType",e(this).attr("dataType")),t(a,"","")}),e("#volunteer-flow3-layer").on("click",".close-btn",function(){e("#volunteer-flow3-layer,.tansLayer").hide()}),e.get("/region/getAllRegion.do",function(t){var a=t.bizData;"0000000"===t.rtnCode&&e.each(a,function(t,a){var n=a.name.replace(/[省,市,自治区]/g,"");e("#province-list").append('<option value="'+n+'">'+n+"</option>")})}),e("#specialty-search-btn").on("click",function(){var n=e("#specialty-input").val().trim(),i=e("#province-list option:selected").val();t(a,i,n)}),e("#volunteer-flow3-layer").on("click",".selSchool",function(){var t=e(this).attr("id"),a=e(this).attr("type"),n=e(this).attr("m_batch"),i=e(this).attr("m_batch_id"),o=e(this).attr("datatypeid"),r=e(this).attr("m_university_name"),l=2014,c="",s=e(this).parents(".school-list").attr("dataType");c="A"==s?"★":"B"==s?"★★":"C"==s?"★★★":"★★★★",e.ajax({url:"/university/universityDetail.do",type:"GET",dataType:"JSON",data:{code:t,type:a,year:l,batch:n},success:function(a){var s=a.bizData;if("0000000"===a.rtnCode){var d="";s.dictName&&(d=s.dictName);var p="<p>院校特征："+d+"<br/>院校隶属："+s.subjection+"<br/>院校类型："+s.type+"<br/>2014年最低投档分："+s.lowestScore+"<br/>2014年最低位次："+s.lowestRanking+" <br/>2014年录取平均分："+s.averageScore+" <br/>2014年平均分位次："+s.averageScoresRanking+" <br/>历年招生情况："+s.enrollIntro+" <br/>录取指数："+c+"</p>";e('.open-flow3[type="text"][dataType="'+o+'"]').val(r).attr({code:t,m_batch:n,m_batch_id:i}),e("#result-info"+o).html(p),e("#tips"+o).hide(),e("#volunteer-flow3-layer,.tansLayer").hide(),e("#specialty"+o).show().attr({m_batch:n,code:t,year:l}).find("input").val("")}}})}),e(".specialty").on("click",".specialty-click",function(){var t=e(this).parents(".specialty").attr("id"),a=e(this).parents("li").index(),n=e(this).parents(".specialty"),i=n.attr("m_batch"),o=n.attr("code"),r=n.attr("year");e("#specialty-content").html(""),e("#specialty-layer,.tansLayer").show(),e.ajax({url:"/majored/majorList.do",type:"GET",dataType:"JSON",data:{code:o,year:r,batch:i},success:function(n){var o=n.bizData;"0000000"===n.rtnCode&&e.each(o,function(n,r){var l=o.length,c=r.name,s=r.subject,d=r.schoolLength,p=r.feeStandard,u=r.planNum,y=(r.id,'<tr><td class="tl"><label id="'+t+'" name="'+c+'" index="'+a+'" specialtyTotal="'+l+'"><input type="radio" name="schoolType" id=""/> '+c+"</label></td><td>"+i+"</td><td>"+s+"</td><td>"+u+"</td><td>"+d+"</td><td>"+p+"</td></tr>");e("#specialty-content").append(y)})}})}),e("#specialty-layer").on("click","label",function(){var t=e(this).attr("id"),a=e(this).attr("index"),n=e(this).attr("name"),i=e(this).attr("specialtyTotal");e("#"+t+" li:eq("+a+")").find("input").val(n).attr({specialtyTotalN:i}).addClass("write"),e("#specialty-layer,.tansLayer").hide()}),e("#specialty-layer").on("click",".close-btn",function(){e("#specialty-layer,.tansLayer").hide()}),e("#volunteer-flow3-btn").on("click",function(){function t(t){e("#specialty-list-info"+t).html(""),e.each(e("#specialty"+t).find("input"),function(a,n){var i="<p>"+(a+1)+"."+e(n).val()+"</p>";e("#specialty-list-info"+t).append(i)}),e.each(e("#specialty"+t),function(t,a){var n=(e(this).find("input").attr("specialtytotaln"),e(this).find("input.write").length),i="";i+=6>n?'<div class="col-list">志愿专业填写不完整</div>':'<div class="col-list">志愿专业填写完整</div>',e("#integrity").append(i)})}if(e(".school-list-col,.enrollmentSchool,#exchange,#integrity,#eva,#enrollment").html(""),""==e("#result-info1").text())return e(".error-tips2").text("请在A志愿中选择学校").fadeIn(1e3).fadeOut(1e3),!1;if(""==e("#result-info2").text())return e(".error-tips2").text("请在B志愿中选择学校").fadeIn(1e3).fadeOut(1e3),!1;if(""==e("#result-info3").text())return e(".error-tips2").text("请在C志愿中选择学校").fadeIn(1e3).fadeOut(1e3),!1;if(""==e("#result-info4").text())return e(".error-tips2").text("请在D志愿中选择学校").fadeIn(1e3).fadeOut(1e3),!1;e("#main1").hide(),e("#main2").show(),e("#print-result-info1").html(e("#result-info1").html()).prepend("<p>"+e('input[type="text"][dataType="1"]').val()+"</p>"),e("#print-result-info2").html(e("#result-info2").html()).prepend("<p>"+e('input[type="text"][dataType="2"]').val()+"</p>"),e("#print-result-info3").html(e("#result-info3").html()).prepend("<p>"+e('input[type="text"][dataType="3"]').val()+"</p>"),e("#print-result-info4").html(e("#result-info4").html()).prepend("<p>"+e('input[type="text"][dataType="4"]').val()+"</p>"),t(1),t(2),t(3),t(4);var n=e('input[name="isFun1"]:checked').val();e("#isFunRadio1").html(n);var i=e('input[name="isFun2"]:checked').val();e("#isFunRadio2").html(i);var o=e('input[name="isFun3"]:checked').val();e("#isFunRadio3").html(o);var r=e('input[name="isFun4"]:checked').val();e("#isFunRadio4").html(r);var l=e('input[type="text"][dataType="1"]').attr("code"),c=e('input[type="text"][dataType="1"]').val(),s=e('input[type="text"][dataType="2"]').attr("code"),d=e('input[type="text"][dataType="2"]').val(),p=e('input[type="text"][dataType="3"]').attr("code"),u=e('input[type="text"][dataType="3"]').val(),y=e('input[type="text"][dataType="4"]').attr("code"),h=e('input[type="text"][dataType="4"]').val(),v=e('input[type="text"][dataType="1"]').attr("m_batch"),m=e('input[type="text"][dataType="1"]').attr("m_batch_id"),f=[{sequence:1,m_university_code:l,m_university_name:c},{sequence:2,m_university_code:s,m_university_name:d},{sequence:3,m_university_code:p,m_university_name:u},{sequence:4,m_university_code:y,m_university_name:h}],x={m_batch_id:m,m_batch:v},_="",b=a.m_kelei;_="文史"==b?0:1;var v=a.m_batch,g={data:f,related:x};e.ajax({url:"/guide/report.do",type:"GET",dataType:"JSON",data:{params:JSON.stringify(g),type:_,year:2014,batch:v},success:function(t){if(console.log(e.parseJSON(t.bizData)),"0000000"==t.rtnCode){var a=e.parseJSON(t.bizData).report,n=a.result,i=n[1].description,o=n[2].description,r=n[3].description;e("#eva").text(i.substr(0,i.length-1)),e("#eva-txt").html(o+r),e.each(a.data,function(t,a){var n='<div class="col-list">'+a.m_university_name+"</div>";e(".school-list-col").append(n)});var l=e.parseJSON(t.bizData).enroll;e.each(l,function(t,a){var n=a.enrollIntro,i=a.name,o='<div class="col-list">'+i+"</div>";e("#enrollmentSchool").append(o);var r='<div class="col-list">'+n+"</div>";e("#enrollment").append(r)})}}}),e.each(e(".isFunRadio"),function(t,a){var n="",i=e(a).text();n+="是"==i?'<div class="col-list obey">志愿专业服从调剂</div>':'<div class="col-list no-obey">志愿专业不服从调剂</div>';var o=n;e("#exchange").append(o)}),console.log(e("#exchange").find(".obey").length);var T=e("#exchange").find(".col-list").length;e("#exchange").find(".obey").length==T?(e("#noObey").hide(),e("#allObey").show()):(e("#noObey").show(),e("#allObey").hide())}),e("#prev-btn").on("click",function(){e("#main1").show(),e("#main2").hide()}),e.get("/info/getUserInfo.do",function(t){if("0000000"==t.rtnCode){var n=t.bizData,i=n.name,o=n.schoolName,r=n.sex,l=n.subjectType;e("#m_candidateNumber").text(a.m_candidateNumber),e("#m_aggregateScore").text(a.m_aggregateScore),e("#m_ranking").text(a.m_ranking);var c=a.m_aggregateScore,s="";s="1"==r?"男":"女";var d="";"1"==l?(d="理科",c>=510?(e("#controlLine").text("510"),e("#controlLine-txt").text("一批本科省控线")):c>=467&&510>c?(e("#controlLine").text("467"),e("#controlLine-txt").text("二批本科省控线")):c>=382&&467>c?(e("#controlLine").text("382"),e("#controlLine-txt").text("三批本科省控线")):(e("#controlLine").text("220"),e("#controlLine-txt").text("高专高职省控线"))):(d="文史",c>=480?(e("#controlLine").text("480"),e("#controlLine-txt").text("一批本科省控线")):c>=440&&480>c?(e("#controlLine").text("440"),e("#controlLine-txt").text("二批本科省控线")):c>=350&&440>c?(e("#controlLine").text("350"),e("#controlLine-txt").text("三批本科省控线")):(e("#controlLine").text("200"),e("#controlLine-txt").text("高专高职省控线"))),e("#studentName").text(i),e("#schoolName").text(o),e("#sexT").text(s),e("#subjectTypeT").text(d)}}),e("#print-btn").on("click",function(){window.print()})})});