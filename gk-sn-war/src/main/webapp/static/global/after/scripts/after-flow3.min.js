define(function(t){var e=t("$");t("backToTop"),e(function(){function t(t,a,i){t.m_province=a,t.m_specialty_name=i,e.ajax({url:"/guide/school.do",type:"GET",dataType:"JSON",data:t,success:function(t){if("0100006"==t.rtnCode||"1000004"==t.rtnCode||"0100005"==t.rtnCode)return void e(".error-tips").text(t.msg).fadeIn(1e3).fadeOut(1e3);if("0000000"==t.rtnCode){var a=e.parseJSON(t.bizData);console.log(a);var i=a.related.m_batch_id,n=a.related.m_batch,l=a.data.result;0==l.data.length&&(e(".no-school").show(),e(".school-list").hide());var o="";"文史"==a.related.m_kelei?o=0:"理工"==a.related.m_kelei&&(o=1);var r=e("#volunteer-flow3-layer").attr("datatype");e(".school-list").html(""),e.each(l.data,function(t,a){0==l.data[t].data.length&&(e(".no-school").show(),e(".school-list").hide()),l.data[t].data.length>0&&4>t&&(e("#no-school"+t).hide(),e("#school-list"+t).show(),e.each(l.data[t].data,function(a,l){var s='<div><span class="fl"><a target="_blank" href="/consult/school_detail.jsp?code='+l.m_university_code+"&batch="+i+'" id="'+l.m_university_code+'">'+l.m_university_name+'</a></span><span class="fr selSchool" datatypeId="'+r+'" m_university_name="'+l.m_university_name+'" id="'+l.m_university_code+'" type = "'+o+'" m_batch_id="'+i+'" m_batch="'+n+'">选择</span></div>';e("#school-list"+t).append(s)}))})}}})}var a=JSON.parse(params);console.log(a),e(".volunteer-flow3-table").on("click",".open-flow3",function(){e(".tansLayer,.volunteer-flow3-layer").show(),e("#volunteer-flow3-layer").attr("dataType",e(this).attr("dataType")),t(a,"","")}),e("#volunteer-flow3-layer").on("click",".close-btn",function(){e("#volunteer-flow3-layer,.tansLayer").hide()}),e.get("/region/getAllRegion.do",function(t){var a=t.bizData;"0000000"===t.rtnCode&&e.each(a,function(t,a){var i=a.name.replace(/[省,市,自治区]/g,"");e("#province-list").append('<option value="'+i+'">'+i+"</option>")})}),e("#specialty-search-btn").on("click",function(){var i=e("#specialty-input").val().trim(),n=e("#province-list option:selected").val();t(a,n,i)}),e("#volunteer-flow3-layer").on("click",".selSchool",function(){var t=e(this).attr("id"),a=e(this).attr("type"),i=e(this).attr("m_batch"),n=e(this).attr("m_batch_id"),l=e(this).attr("datatypeid"),o=e(this).attr("m_university_name");console.log(t+"+"+a+"+"+i+"+"+n+"+"+l+"+"+o);var r=2014,s="",c=e(this).parents(".school-list").attr("dataType");s="A"==c?"★":"B"==c?"★★":"C"==c?"★★★":"★★★★",e.ajax({url:"/university/universityDetail.do",type:"GET",dataType:"JSON",data:{code:t,type:a,year:r,batch:i},success:function(a){console.log(a),console.log(1);var c=a.bizData;if("0000000"===a.rtnCode){var d="";c.dictName&&(d=c.dictName);var p="<p>院校特征："+d+"<br/>院校隶属："+c.subjection+"<br/>院校类型："+c.type+"<br/>2014年最低投档分："+c.lowestScore+"<br/>2014年最低位次："+c.lowestRanking+" <br/>2014年录取平均分："+c.averageScore+" <br/>2014年平均分位次："+c.averageScoresRanking+" <br/>历年招生情况："+c.enrollIntro+" <br/>录取指数："+s+"</p>";e('.open-flow3[type="text"][dataType="'+l+'"]').val(o).attr({code:t,m_batch:i,m_batch_id:n}),e("#result-info"+l).html(p),e("#tips"+l).hide(),e("#volunteer-flow3-layer,.tansLayer").hide(),e("#specialty"+l).show().attr({m_batch:i,code:t,year:r}).find("input").val("")}}})}),e(".specialty").on("click",".specialty-click",function(){var t=e(this).parents(".specialty").attr("id"),a=e(this).parents("li").index(),i=e(this).parents(".specialty"),n=i.attr("m_batch"),l=i.attr("code"),o=i.attr("year");console.log(n+"="+l+"="+o),e("#specialty-content").html(""),e("#specialty-layer,.tansLayer").show(),e.ajax({url:"/majored/majorList.do",type:"GET",dataType:"JSON",data:{code:l,year:o,batch:n},success:function(i){console.log(i);var l=i.bizData;"0000000"===i.rtnCode&&e.each(l,function(i,o){var r=l.length,s=o.name,c=o.subject,d=o.schoolLength,p=o.feeStandard,u=o.planNum,y=(o.id,'<tr><td class="tl"><label id="'+t+'" name="'+s+'" index="'+a+'" specialtyTotal="'+r+'"><input type="radio" name="schoolType" id=""/> '+s+"</label></td><td>"+n+"</td><td>"+c+"</td><td>"+u+"</td><td>"+d+"</td><td>"+p+"</td></tr>");e("#specialty-content").append(y)})}})}),e("#specialty-layer").on("click","label",function(){var t=e(this).attr("id"),a=e(this).attr("index"),i=e(this).attr("name");console.log(t+"="+i);var n=e(this).attr("specialtyTotal");e("#"+t+" li:eq("+a+")").find("input").val(i).attr({specialtyTotalN:n}).addClass("write"),e("#specialty-layer,.tansLayer").hide()}),e("#specialty-layer").on("click",".close-btn",function(){e("#specialty-layer,.tansLayer").hide()}),e("#volunteer-flow3-btn").on("click",function(){function t(t){e("#specialty-list-info"+t).html(""),e.each(e("#specialty"+t).find("input"),function(a,i){var n="<p>"+(a+1)+"."+e(i).val()+"</p>";e("#specialty-list-info"+t).append(n)}),e.each(e("#specialty"+t),function(t,a){console.log(e(this).find("input").attr("specialtytotaln"));var i=e(this).find("input").attr("specialtytotaln"),n=e(this).find("input.write").length;console.log(i+"--"+n);var l="";l+=6>n?'<div class="col-list col-list2">志愿专业填写不完整</div>':'<div class="col-list col-list2">志愿专业填写完整</div>',e("#integrity").append(l)})}if(e(".school-list-col,.enrollmentSchool,#exchange,#integrity,#eva,#enrollment").html(""),""==e("#result-info1").text())return e(".error-tips2").text("请在A志愿中选择学校").fadeIn(1e3).fadeOut(1e3),!1;if(""==e("#result-info2").text())return e(".error-tips2").text("请在B志愿中选择学校").fadeIn(1e3).fadeOut(1e3),!1;if(""==e("#result-info3").text())return e(".error-tips2").text("请在C志愿中选择学校").fadeIn(1e3).fadeOut(1e3),!1;if(""==e("#result-info4").text())return e(".error-tips2").text("请在D志愿中选择学校").fadeIn(1e3).fadeOut(1e3),!1;e("#main1").hide(),e("#main2").show(),e("#print-result-info1").html(e("#result-info1").html()).prepend("<p>"+e('input[type="text"][dataType="1"]').val()+"</p>"),e("#print-result-info2").html(e("#result-info2").html()).prepend("<p>"+e('input[type="text"][dataType="2"]').val()+"</p>"),e("#print-result-info3").html(e("#result-info3").html()).prepend("<p>"+e('input[type="text"][dataType="3"]').val()+"</p>"),e("#print-result-info4").html(e("#result-info4").html()).prepend("<p>"+e('input[type="text"][dataType="4"]').val()+"</p>"),t(1),t(2),t(3),t(4);var i=e('input[name="isFun1"]:checked').val();e("#isFunRadio1").html(i);var n=e('input[name="isFun2"]:checked').val();e("#isFunRadio2").html(n);var l=e('input[name="isFun3"]:checked').val();e("#isFunRadio3").html(l);var o=e('input[name="isFun4"]:checked').val();e("#isFunRadio4").html(o);var r=e('input[type="text"][dataType="1"]').attr("code"),s=e('input[type="text"][dataType="1"]').val(),c=e('input[type="text"][dataType="2"]').attr("code"),d=e('input[type="text"][dataType="2"]').val(),p=e('input[type="text"][dataType="3"]').attr("code"),u=e('input[type="text"][dataType="3"]').val(),y=e('input[type="text"][dataType="4"]').attr("code"),h=e('input[type="text"][dataType="4"]').val(),v=e('input[type="text"][dataType="1"]').attr("m_batch"),m=e('input[type="text"][dataType="1"]').attr("m_batch_id"),f=[{sequence:1,m_university_code:r,m_university_name:s},{sequence:2,m_university_code:c,m_university_name:d},{sequence:3,m_university_code:p,m_university_name:u},{sequence:4,m_university_code:y,m_university_name:h}],_={m_batch_id:m,m_batch:v},b="",x=a.m_kelei;b="文史"==x?0:1;var v=a.m_batch,g={data:f,related:_};e.ajax({url:"/guide/report.do",type:"GET",dataType:"JSON",data:{params:JSON.stringify(g),type:b,year:2014,batch:v},success:function(t){if(console.log(t),"0000000"==t.rtnCode){var a=e.parseJSON(t.bizData).report,i=a.description;e("#eva").text(i),e.each(a.data,function(t,a){var i='<div class="col-list">'+a.m_university_name+"</div>";e(".school-list-col").append(i)});var n=e.parseJSON(t.bizData).enroll;console.log(e.parseJSON(t.bizData)),e.each(n,function(t,a){var i=a.enrollIntro,n=a.name,l='<div class="col-list">'+n+"</div>";e("#enrollmentSchool").append(l);var o='<div class="col-list col-list2">'+i+"</div>";e("#enrollment").append(o)})}}}),e.each(e(".isFunRadio"),function(t,a){var i="",n=e(a).text();i+="是"==n?"志愿专业服从调剂":"志愿专业不服从调剂";var l='<div class="col-list col-list2">'+i+"</div>";e("#exchange").append(l)})}),e("#prev-btn").on("click",function(){e("#main1").show(),e("#main2").hide()}),e.get("/info/getUserInfo.do",function(t){if("0000000"==t.rtnCode){var a=t.bizData,i=a.name,n=a.schoolName,l=a.sex,o=a.subjectType,r="";r="1"==l?"男":"女";var s="";s="1"==o?"理科":"文史",e("#studentName").text(i),e("#schoolName").text(n),e("#sexT").text(r),e("#subjectTypeT").text(s)}}),e("#print-btn").on("click",function(){window.print()})})});