define(function(t){function e(){bdhtml=window.document.body.innerHTML,sprnstr="<!--startprint-->",eprnstr="<!--endprint-->",prnhtml=bdhtml.substr(bdhtml.indexOf(sprnstr)+17),prnhtml=prnhtml.substring(0,prnhtml.indexOf(eprnstr)),window.document.body.innerHTML=prnhtml,window.print()}var a=t("$");t("backToTop"),a(function(){function t(t,e,n){t.m_province=e,t.m_specialty_name=n,a.ajax({url:"/guide/school.do",type:"GET",dataType:"JSON",data:t,success:function(t){if("0100006"==t.rtnCode||"1000004"==t.rtnCode||"0100005"==t.rtnCode)return void a(".error-tips").text(t.msg).fadeIn(1e3).fadeOut(1e3);if("0000000"==t.rtnCode){var e=a.parseJSON(t.bizData),n=e.related.m_batch_id,i=e.related.m_batch,r=e.data.result;0==r.data.length&&(a(".no-school").show(),a(".school-list").hide());var o="";"文史"==e.related.m_kelei?o=0:"理工"==e.related.m_kelei&&(o=1);var l=a("#volunteer-flow3-layer").attr("datatype");a(".school-list").html(""),a.each(r.data,function(t,e){r.data[t].data.length>0&&4>t?(a("#no-school"+t).hide(),a("#school-list"+t).show(),a.each(r.data[t].data,function(e,r){var c='<div><span class="fl"><a target="_blank" href="/consult/school_detail.jsp?code='+r.m_university_code+"&batch="+n+'" id="'+r.m_university_code+'">'+r.m_university_name+'</a></span><span class="fr selSchool" datatypeId="'+l+'" m_university_name="'+r.m_university_name+'" id="'+r.m_university_code+'" type = "'+o+'" m_batch_id="'+n+'" m_batch="'+i+'">选择</span></div>';a("#school-list"+t).append(c)})):(a("#no-school"+t).show(),a("#school-list"+t).hide())})}}})}var n=JSON.parse(params);console.log(n),a(".volunteer-flow3-table").on("click",".open-flow3",function(){a(".tansLayer,.volunteer-flow3-layer").show(),a("#volunteer-flow3-layer").attr("dataType",a(this).attr("dataType")),t(n,"","")}),a("#volunteer-flow3-layer").on("click",".close-btn",function(){a("#volunteer-flow3-layer,.tansLayer").hide()}),a.get("/region/getAllRegion.do",function(t){var e=t.bizData;"0000000"===t.rtnCode&&a.each(e,function(t,e){var n=e.name.replace(/[省,市,自治区]/g,"");a("#province-list").append('<option value="'+n+'">'+n+"</option>")})}),a("#specialty-search-btn").on("click",function(){var e=a("#specialty-input").val().trim(),i=a("#province-list option:selected").val();t(n,i,e)}),a("#volunteer-flow3-layer").on("click",".selSchool",function(){var t=a(this).attr("id"),e=a(this).attr("type"),n=a(this).attr("m_batch"),i=a(this).attr("m_batch_id"),r=a(this).attr("datatypeid"),o=a(this).attr("m_university_name"),l=2014,c="",s=a(this).parents(".school-list").attr("dataType");c="A"==s?"★":"B"==s?"★★":"C"==s?"★★★":"★★★★",a.ajax({url:"/university/universityDetail.do",type:"GET",dataType:"JSON",data:{code:t,type:e,year:l,batch:n},success:function(e){var s=e.bizData;if("0000000"===e.rtnCode){var d="";s.dictName&&(d=s.dictName);var p="<p>院校特征："+d+"<br/>院校隶属："+s.subjection+"<br/>院校类型："+s.type+"<br/>2014年最低投档分："+s.lowestScore+"<br/>2014年最低位次："+s.lowestRanking+" <br/>2014年录取平均分："+s.averageScore+" <br/>2014年平均分位次："+s.averageScoresRanking+" <br/>历年招生情况："+s.enrollIntro+" <br/>录取指数："+c+"</p>";a('.open-flow3[type="text"][dataType="'+r+'"]').val(o).attr({code:t,m_batch:n,m_batch_id:i}),a("#result-info"+r).html(p),a("#tips"+r).hide(),a("#volunteer-flow3-layer,.tansLayer").hide(),a("#specialty"+r).show().attr({m_batch:n,code:t,year:l}).find("input").val("")}}})}),a(".specialty").on("click",".specialty-click",function(){var t=a(this).parents(".specialty").attr("id"),e=a(this).parents("li").index(),n=a(this).parents(".specialty"),i=n.attr("m_batch"),r=n.attr("code"),o=n.attr("year");a("#specialty-content").html(""),a("#specialty-layer,.tansLayer").show(),a.ajax({url:"/majored/majorList.do",type:"GET",dataType:"JSON",data:{code:r,year:o,batch:i},success:function(n){var r=n.bizData;"0000000"===n.rtnCode&&a.each(r,function(n,o){var l=r.length,c=o.name,s=o.subject,d=o.schoolLength,p=o.feeStandard,u=o.planNum,h=(o.id,'<tr><td class="tl"><label id="'+t+'" name="'+c+'" index="'+e+'" specialtyTotal="'+l+'"><input type="radio" name="schoolType" id=""/> '+c+"</label></td><td>"+i+"</td><td>"+s+"</td><td>"+u+"</td><td>"+d+"</td><td>"+p+"</td></tr>");a("#specialty-content").append(h)})}})}),a("#specialty-layer").on("click","label",function(){var t=a(this).attr("id"),e=a(this).attr("index"),n=a(this).attr("name"),i=a(this).attr("specialtyTotal");a("#"+t+" li:eq("+e+")").find("input").val(n).attr({specialtyTotalN:i}).addClass("write"),a("#specialty-layer,.tansLayer").hide()}),a("#specialty-layer").on("click",".close-btn",function(){a("#specialty-layer,.tansLayer").hide()}),a("#volunteer-flow3-btn").on("click",function(){function t(t){a("#specialty-list-info"+t).html(""),a.each(a("#specialty"+t).find("input"),function(e,n){var i="<p>"+(e+1)+"."+a(n).val()+"</p>";a("#specialty-list-info"+t).append(i)}),a.each(a("#specialty"+t),function(t,e){var n=(a(this).find("input").attr("specialtytotaln"),a(this).find("input.write").length),i="";i+=6>n?'<div class="col-list">志愿专业填写不完整</div>':'<div class="col-list">志愿专业填写完整</div>',a("#integrity").append(i)})}if(a(".school-list-col,.enrollmentSchool,#exchange,#integrity,#eva,#enrollment").html(""),""==a("#result-info1").text())return a(".error-tips2").text("请在A志愿中选择学校").fadeIn(1e3).fadeOut(1e3),!1;if(""==a("#result-info2").text())return a(".error-tips2").text("请在B志愿中选择学校").fadeIn(1e3).fadeOut(1e3),!1;if(""==a("#result-info3").text())return a(".error-tips2").text("请在C志愿中选择学校").fadeIn(1e3).fadeOut(1e3),!1;if(""==a("#result-info4").text())return a(".error-tips2").text("请在D志愿中选择学校").fadeIn(1e3).fadeOut(1e3),!1;a("#main1").hide(),a("#main2").show(),a("#print-result-info1").html(a("#result-info1").html()).prepend("<p>"+a('input[type="text"][dataType="1"]').val()+"</p>"),a("#print-result-info2").html(a("#result-info2").html()).prepend("<p>"+a('input[type="text"][dataType="2"]').val()+"</p>"),a("#print-result-info3").html(a("#result-info3").html()).prepend("<p>"+a('input[type="text"][dataType="3"]').val()+"</p>"),a("#print-result-info4").html(a("#result-info4").html()).prepend("<p>"+a('input[type="text"][dataType="4"]').val()+"</p>"),t(1),t(2),t(3),t(4);var e=a('input[name="isFun1"]:checked').val();a("#isFunRadio1").html(e);var i=a('input[name="isFun2"]:checked').val();a("#isFunRadio2").html(i);var r=a('input[name="isFun3"]:checked').val();a("#isFunRadio3").html(r);var o=a('input[name="isFun4"]:checked').val();a("#isFunRadio4").html(o);var l=a('input[type="text"][dataType="1"]').attr("code"),c=a('input[type="text"][dataType="1"]').val(),s=a('input[type="text"][dataType="2"]').attr("code"),d=a('input[type="text"][dataType="2"]').val(),p=a('input[type="text"][dataType="3"]').attr("code"),u=a('input[type="text"][dataType="3"]').val(),h=a('input[type="text"][dataType="4"]').attr("code"),y=a('input[type="text"][dataType="4"]').val(),m=a('input[type="text"][dataType="1"]').attr("m_batch"),v=a('input[type="text"][dataType="1"]').attr("m_batch_id"),f=[{sequence:1,m_university_code:l,m_university_name:c},{sequence:2,m_university_code:s,m_university_name:d},{sequence:3,m_university_code:p,m_university_name:u},{sequence:4,m_university_code:h,m_university_name:y}],x={m_batch_id:v,m_batch:m},_="",b=n.m_kelei;_="文史"==b?0:1;var m=n.m_batch,g={data:f,related:x};a.ajax({url:"/guide/report.do",type:"GET",dataType:"JSON",data:{params:JSON.stringify(g),type:_,year:2014,batch:m},success:function(t){if("0000000"==t.rtnCode){var e=a.parseJSON(t.bizData).report,n=e.result,i=n[1].description,r=n[2].description,o=n[3].description;a("#eva").text(i.substr(0,i.length-1)),a("#eva-txt").html(r+o),a.each(e.data,function(t,e){var n='<div class="col-list">'+e.m_university_name+"</div>";a(".school-list-col").append(n)});var l=a.parseJSON(t.bizData).enroll;a.each(l,function(t,e){var n=e.enrollIntro,i=e.name,r='<div class="col-list">'+i+"</div>";a("#enrollmentSchool").append(r);var o='<div class="col-list">'+n+"</div>";a("#enrollment").append(o)})}}}),a.each(a(".isFunRadio"),function(t,e){var n="",i=a(e).text();n+="是"==i?'<div class="col-list obey">志愿专业服从调剂</div>':'<div class="col-list no-obey">志愿专业不服从调剂</div>';var r=n;a("#exchange").append(r)}),console.log(a("#exchange").find(".obey").length);var T=a("#exchange").find(".col-list").length;a("#exchange").find(".obey").length==T?(a("#noObey").hide(),a("#allObey").show()):(a("#noObey").show(),a("#allObey").hide())}),a("#prev-btn").on("click",function(){a("#main1").show(),a("#main2").hide()}),a.get("/info/getUserInfo.do",function(t){if("0000000"==t.rtnCode){var e=t.bizData,i=e.name,r=e.schoolName,o=e.sex;a("#m_candidateNumber").text(n.m_candidateNumber),a("#m_aggregateScore").text(n.m_aggregateScore),a("#m_ranking").text(n.m_ranking),a("#m_kelei").text(n.m_kelei);var l=n.m_aggregateScore,c="";c="1"==o?"男":"女";var s=n.m_kelei;"文史"==s?l>=510?(a("#controlLine").text("510"),a("#controlLine-txt").text("一批本科省控线")):l>=467&&510>l?(a("#controlLine").text("467"),a("#controlLine-txt").text("二批本科省控线")):l>=382&&467>l?(a("#controlLine").text("382"),a("#controlLine-txt").text("三批本科省控线")):(a("#controlLine").text("220"),a("#controlLine-txt").text("高专高职省控线")):"理工"==s&&(l>=480?(a("#controlLine").text("480"),a("#controlLine-txt").text("一批本科省控线")):l>=440&&480>l?(a("#controlLine").text("440"),a("#controlLine-txt").text("二批本科省控线")):l>=350&&440>l?(a("#controlLine").text("350"),a("#controlLine-txt").text("三批本科省控线")):(a("#controlLine").text("200"),a("#controlLine-txt").text("高专高职省控线"))),a("#studentName").text(i),a("#schoolName").text(r),a("#sexT").text(c)}}),a("#print-btn").on("click",function(){e()})})});