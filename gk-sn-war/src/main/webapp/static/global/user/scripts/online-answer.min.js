define(function(t){function e(t){var e=new RegExp("(^|\\?|&)"+t+"=([^&]*)(\\s|&|$)","i");return e.test(window.location.href)?unescape(RegExp.$2.replace(/\+/g," ")):""}var n=t("$");t("header-user");var i={startSize:0,endSize:5,next:n(".next-btn"),render:function(t){for(var e=[],n=0,i=t.length;i>n;n++){for(var a=t[n].question,s=a.questions,o=[],r=0,d=s.length;d>r;r++)o.push(s[r].text);var l=new Date(a.createTime).Format("yyyy-MM-dd hh:mm"),c=t[n].answer,g=c.answers,u=[];if(g)for(var h=0,p=g.length;p>h;h++){var v=g[h].text;g[h].text.length>200&&(v=v.substring(0,200)),u.push("<p>"+v+"</p>"),g[h].img&&u.push('<p class="ta"><img src="'+g[h].img+'" /></p>')}var m=o.join("");m.length>50&&(m=m.substring(0,50)),e.push('<a href="/question/question_detail.jsp?id='+a.questionId+'"><div class="detail-content"><div class="detail-header"><span class="order-number">'+(n+1+this.startSize)+'、</span><span class="detail-title">'+m+'</span><span class="upload-time">'+l+"</span></div>"),u.length>0&&e.push('<div class="detail-info"><img class="triangle" src="http://cdn.gaokao360.net/static/global/common/images/triangle.png" />'+u.join("")+"</div>"),e.push("</div></a>")}return e.join("")},getMyQuestion:function(t,e){var n="/answer/findMyQuestion.do?";this.getData(n,t,e)},getData:function(t,e,i){var a=this,s=n("#keywords").val().trim();n.get(t+"startSize="+this.startSize+"&endSize="+this.endSize+"&isAnswer="+i+"&keyword="+s,function(t){"0000000"===t.rtnCode&&(t.bizData.length>0?(t.bizData.length>5?a.next.show():a.next.hide(),0==a.startSize?n("#"+e).html(a.render(t.bizData)):n("#"+e).append(a.render(t.bizData))):0==a.startSize?(n("#"+e).html(a.getTipTmpl("暂时没有数据，请耐心等待哦")),a.next.hide()):(a.next.text("暂无更多信息！"),a.next.off("click")))}).error(function(t){n("#"+e).html(a.getTipTmpl("服务器开小差啦~ ~ ~"))})},getTipTmpl:function(t){return'<div class="error-tip-new"><img src="http://cdn.gaokao360.net/static/global/common/images/no-data-logo.png" /><p class="ta">'+t+"</p></div>"},addNextPageHandle:function(){this.startSize+=5,this.endSize+=5;var t=n(".toggle-nav div.btn-selected").attr("data-isAnswer");this.getMyQuestion("detail_content_question",t)}};n(document).ready(function(){var t=e("method");"ask"===t?(n(".ask").addClass("btn-selected").siblings().removeClass("btn-selected"),i.getMyQuestion("detail_content_question",0)):i.getMyQuestion("detail_content_question",1),i.next.on("click",function(t){i.addNextPageHandle()}),n("#search").on("click",function(t){var e=n(".toggle-nav div.btn-selected").attr("data-isAnswer");i.startSize=0,i.endSize=5,i.getMyQuestion("detail_content_question",e)}),n("#keywords").keydown(function(t){if(13==t.keyCode){var e=n("#keywords").val().trim();if(e){var a=n(".toggle-nav div.btn-selected").attr("data-isAnswer");i.startSize=0,i.endSize=5,i.getMyQuestion("detail_content_question",a)}}}),n(".toggle-nav div.btn").on("click",function(){if(!n(this).hasClass("btn-selected")){n(this).addClass("btn-selected").siblings().removeClass("btn-selected");var t=n(this).attr("data-isAnswer");i.startSize=0,i.endSize=5,i.getMyQuestion("detail_content_question",t)}})})});