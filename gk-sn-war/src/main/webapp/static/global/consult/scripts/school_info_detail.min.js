define(function(t){function e(t){var e=new RegExp("(^|\\?|&)"+t+"=([^&]*)(\\s|&|$)","i");return e.test(window.location.href)?unescape(RegExp.$2.replace(/\+/g," ")):""}function n(t,e){var n=new RegExp(e?t+"=(?:.*?&)*?"+e+"=([^&;$]*)":t+"=([^;$]*)","i");return n.test(unescape(document.cookie))?RegExp.$1:""}var i=t("$");t("backToTop");var a={getBasicInfo:function(e,l){var s=this;i.ajax({type:"GET",url:"/university/getUniversityDetail.do?"+e+"="+l,dataType:"json",success:function(e){var l=e.bizData.id;if(n("snuser")&&a.getIsCollect(l),"0000000"===e.rtnCode){s.renderInfo(e.bizData),a.schoolIntro(l);i("#tabs-list").on("click","li",function(){i("#tabs-content").html("");var t=i(this),e=t.attr("rel");t.addClass("active").siblings().removeClass("active"),"院校简介"==e?a.schoolIntro(l):"招生简章"==e?a.brochures(l):"往年招生情况"==e?a.getSchoolInfo(l):"往年招生计划"==e?a.getEnroll(l):"专业录取分数"==e?a.admitAMark(l):"开设专业"==e&&a.openSpecialty(l)})}else{var o=t("pageErrorTip");i("#info_content").html(o("数据维护中"))}},error:function(e){var n=t("pageErrorTip");i("#info_content").html(n("数据维护中"))}})},renderInfo:function(t){var e="院校地址："+(t.address||""),a="";e.length>17&&(a="integet-line");var l="联系电话："+(t.contactPhone||""),s="";l.length>16&&(s="integet-line");var o="院校网址："+(t.url||""),d="";o.length>20&&(d="integet-line");var c="";n("snuser")&&'""'!=n("snuser")?c="javascript:;":(console.log("没有登录111"),c="/login/login.jsp"),i("#info_content").html('<a target="_blank" href="'+c+'" id="collect" class="collect"><span>收藏</span><i></i></a><img class="fl" src="'+(t.universityImage||"http://cdn.gaokao360.net/static/global/common/images/kqbk_banner_default.png")+'" /><div class="info"><ul><li class="school-name">'+(t.name||"")+"</li><li>所在省份："+(t.provinceName||"")+"</li><li>院校隶属："+(t.subjection||"")+"</li><li>学历层次："+(t.educatLevel||"")+"</li><li>院校特征："+(t.property||"")+"</li><li>院校类型："+(t.universityType||"")+'</li><li class="'+d+'">院校网址：<a class="website" target="_blank" href="'+t.url+'">'+(t.url||"")+'</a></li><li class="'+a+'">'+e+'</li><li class="'+s+'">联系电话：<span>'+(t.contactPhone||"")+"</span></li></ul></div>")},getIsCollect:function(t){i.get("/userCollection/isUniversityCollect.do?universityId="+t,function(e){if(e.rtnCode="0000000"){var n=e.bizData;0==n?i("#collect").removeClass("active").find("span").text("收藏"):i("#collect").addClass("active").find("span").text("取消收藏"),i("#info_content").on("click","#collect",function(){"收藏"==i("#collect").find("span").text()?a.saveUserCollect(t):a.deleteUserCollect(t)})}})},saveUserCollect:function(t){i.get("/userCollection/saveUserCollect.do?universityId="+t,function(t){"0000000"==t.rtnCode&&i("#collect").addClass("active").find("span").text("取消收藏")})},deleteUserCollect:function(t){i.get("/userCollection/deleteUserCollect.do?universityId="+t,function(t){"0000000"==t.rtnCode&&i("#collect").removeClass("active").find("span").text("收藏")})},schoolIntro:function(t){i.get("/university/getUniversityIntro.do?universityId="+t,function(t){"0000000"==t.rtnCode&&i("#tabs-content").html(t.bizData.universityIntro)})},brochures:function(t){i.get("/university/getEntroIntro.do?universityId="+t,function(t){"0000000"==t.rtnCode&&i("#tabs-content").html(t.bizData.entroIntro)})},getSchoolInfo:function(t){var e=this;i.get(" /university/getEnrollInfo.do?id="+t,function(t){"0000000"==t.rtnCode&&e.renderSchool(t.bizData.enrollInfo)})},renderSchool:function(t){for(var e='<div id="tabs_list_last" class="tabs-ui"><ul>',n="",a=0;a<t.length;a++){var l=t[a].title;e+="<li>"+l+"</li>",n+='<div style="display:none" class="school-table mt20"><table border="0" cellpadding="0" cellspacing="0"><thead><tr><th></th><th>计划数</th><th>录取数</th><th>最高分</th><th>最高位次</th><th>最低分</th><th>最低位次</th><th>平均分</th><th>平均分位次</th></tr></thead><tbody>';for(var s=0;s<t[a].infos.length;s++){var o=t[a].infos[s];n+="<tr><td>"+(o.subjectName||"")+"</td><td>"+(o.planNumber||"")+"</td><td>"+(o.enrollNumber||"")+"</td><td>"+(o.highestScore||"")+"</td><td>"+(o.highestRank||"")+"</td><td>"+(o.lowestScore||"")+"</td><td>"+(o.lowestRank||"")+"</td><td>"+(o.averageScore||"")+"</td><td>"+(o.averageRank||"")+"</td></tr>"}n+="</tbody></table></div>"}e+="</ul></div>",i("#tabs-content").append(e).append(n).on("click","li",function(){var t=i(this),e=t.index(),n=t.parents("#tabs-content");t.addClass("active").siblings().removeClass("active"),n.find(".school-table").hide(),n.find(".school-table:eq("+e+")").show()}),i("#tabs_list_last").find("li:eq(0)").click()},getEnroll:function(t){var n=this,a=e("batch");console.log(a),i.get("/university/getEnrollPlan.do?id="+t+"&batch="+a,function(t){"0000000"==t.rtnCode&&n.renderEnroll(t.bizData.enrollPlan)})},renderEnroll:function(t){for(var e='<div id="tabs_list_last" class="tabs-ui"><ul>',n="",a=0;a<t.length;a++){var l=t[a].title;e+="<li>"+l+"</li>",n+='<div style="display:none" class="school-table mt20"><div class="subjectType"><label><input type="radio" name="subject1" id=""/> <span>文史</span></label><label><input type="radio" name="subject1" id=""/> <span>理科</span></label></div><table border="0" cellpadding="0" cellspacing="0"><thead><tr><th  class="name">专业名称</th><th>批次</th><th>科类</th><th>计划人数</th><th>学制</th><th>收费标准</th></tr></thead><tbody>';for(var s=0;s<t[a].planInfos.length;s++){var o=t[a].planInfos[s];n+='<tr batch="'+o.subject+'"><td width="50%" class="name">'+(o.majoredName||"")+'</td><td width="10%">'+(o.batch||"")+'</td><td width="10%">'+(o.subject||"")+'</td><td width="10%">'+(o.planNumber||"")+'</td><td width="10%">'+(o.schoolLength||"")+'</td><td width="10%">'+(o.feeStandard||"")+"</td></tr>"}n+="</tbody></table></div>"}e+="</ul></div>",i("#tabs-content").append(e).append(n).on("click","li",function(){var t=i(this),e=t.index(),n=t.parents("#tabs-content");n.find("tr").show(),n.find("label").removeClass("active").find("input").attr("checked",!1),t.addClass("active").siblings().removeClass("active"),n.find(".school-table").hide(),n.find(".school-table:eq("+e+")").show().find("label").on("click",function(){i(this).addClass("active").siblings().removeClass("active");var t=i(this).find("span").text(),e=i(this).parents(".school-table").find('tr[batch="文史"]'),n=i(this).parents(".school-table").find('tr[batch="理工"]');"文史"==t?(n.hide(),e.show()):(e.hide(),n.show())})}),i("#tabs_list_last").find("li:eq(0)").click()},admitAMark:function(t){var e=this;i.get("/university/getMajoredScoreLineList.do?universityId="+t,function(t){console.log(t),"0000000"==t.rtnCode&&e.renderAdmitAMark(t.bizData)})},renderAdmitAMark:function(t){var e='<div id="tabs_list_last" class="tabs-ui"><ul>',n="";for(var a in t){var l=a;e+="<li>"+l+"</li>",n+='<div style="display:none" class="school-table mt20"><div class="subjectType"><label><input type="radio" name="subject1" id=""/> <span>文史</span></label><label><input type="radio" name="subject1" id=""/> <span>理科</span></label></div><table border="0" cellpadding="0" cellspacing="0"><thead><tr><th>专业名称</th><th>科类</th><th>录取最高分</th><th>录取最低分</th><th>录取平均分</th></tr></thead><tbody>';for(var s=0;s<t[a].length;s++){var o=t[a][s];n+='<tr batch="'+o.subject+'"><td>'+(o.majoredName||"-")+"</td><td>"+(o.subject||"-")+"</td><td>"+o.highestScore+"</td><td>"+o.lowestScore+"</td><td>"+o.averageScore+"</td></tr>"}n+="</tbody></table></div>"}e+="</ul></div>",i("#tabs-content").append(e).append(n).on("click","li",function(){var t=i(this),e=t.index(),n=t.parents("#tabs-content");n.find("tr").show(),n.find("label").removeClass("active").find("input").attr("checked",!1),t.addClass("active").siblings().removeClass("active"),n.find(".school-table").hide(),n.find(".school-table:eq("+e+")").show().find("label").on("click",function(){i(this).addClass("active").siblings().removeClass("active");var t=i(this).find("span").text(),e=i(this).parents(".school-table").find('tr[batch="文史"]'),n=i(this).parents(".school-table").find('tr[batch="理工"]');console.log(i(this).parents(".school-table").find("tr").html()),"文史"==t?(n.hide(),e.show()):(e.hide(),n.show())})}),i("#tabs_list_last").find("li:eq(0)").click()},openSpecialty:function(t){i.get("/university/getOpenMajoredPojoList.do?universityId="+t,function(t){console.log(t);var e=t.bizData;if("0000000"==t.rtnCode){for(var n='<div style="display:block" class="school-table mt20"><div class="tipTxt"><strong>温馨提示：</strong> <i class="star"></i>号表示该专业在该院校招生</div><table border="0" cellpadding="0" cellspacing="0"><thead><tr><th>专业名称</th><th>科类</th><th>薪资排名</th><th>就业率排名</th></tr></thead><tbody>',a=0;a<e.length;a++){var l=e[a].employmentRateRank,s=e[a].isEnrol,o=e[a].majoredName,d=e[a].salaryRank,c=e[a].subject,r="";r=1==s?'<i class="star"></i>':"",n+="<tr><td>"+r+o+"</td><td>"+(c||"-")+"</td><td>"+d+"</td><td>"+l+"</td></tr>"}n+="</tbody></table></div>",i("#tabs-content").append(n)}})}};i(document).ready(function(){var t=e("code"),n=e("id");t?a.getBasicInfo("code",t):n&&a.getBasicInfo("id",n)})});