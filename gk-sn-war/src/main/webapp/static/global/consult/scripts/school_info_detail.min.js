define(function(t){function e(t){var e=new RegExp("(^|\\?|&)"+t+"=([^&]*)(\\s|&|$)","i");return e.test(window.location.href)?unescape(RegExp.$2.replace(/\+/g," ")):""}function a(t,e){var a=new RegExp(e?t+"=(?:.*?&)*?"+e+"=([^&;$]*)":t+"=([^;$]*)","i");return a.test(unescape(document.cookie))?RegExp.$1:""}var n=t("$");t("backToTop");var i=t("pageErrorTip"),l={getBasicInfo:function(e,i){var s=this;n.ajax({type:"GET",url:"/university/getUniversityDetail.do?"+e+"="+i,dataType:"json",success:function(e){var i=e.bizData.id;if(a("snuser")&&l.getIsCollect(i),"0000000"===e.rtnCode){s.renderInfo(e.bizData),l.schoolIntro(i);n("#tabs-list").on("click","li",function(){var t=n(this),e=t.attr("rel"),a=t.index();t.addClass("active").siblings().removeClass("active"),n(".tabs-content:eq("+a+")").show().siblings(".tabs-content").hide(),"院校简介"==e?(n("#tabs-content1").show(),n("#tabs-content1").attr("flag")||l.schoolIntro(i)):"招生简章"==e?n("#tabs-content2").attr("flag")||l.brochures(i):"往年招生情况"==e?n("#tabs-content3").attr("flag")||l.getSchoolInfo(i):"往年招生计划"==e?n("#tabs-content4").attr("flag")||l.getEnroll(i):"专业录取分数"==e?n("#tabs-content5").attr("flag")||l.admitAMark(i):"开设专业"==e&&(n("#tabs-content6").attr("flag")||l.openSpecialty(i))}),n("#tabs-list li:eq(0)").click()}else{var o=t("pageErrorTip");n("#info_content").html(o("数据维护中"))}},error:function(e){var a=t("pageErrorTip");n("#info_content").html(a("数据维护中"))}})},renderInfo:function(t){var e="院校地址："+(t.address||""),i="";e.length>17&&(i="integet-line");var l="联系电话："+(t.contactPhone||""),s="";l.length>16&&(s="integet-line");var o="院校网址："+(t.url||""),r="";o.length>20&&(r="integet-line");var d="";a("snuser")&&'""'!=a("snuser")?d="javascript:;":(console.log("没有登录111"),d="/login/login.jsp"),n("#info_content").html('<a target="_blank" href="'+d+'" id="collect" class="collect"><span>收藏</span><i></i></a><img class="fl" src="'+(t.universityImage||"http://cdn.gaokao360.net/static/global/common/images/kqbk_banner_default.png")+'" /><div class="info"><ul><li class="school-name">'+(t.name||"")+"</li><li>所在省份："+(t.provinceName||"")+"</li><li>院校隶属："+(t.subjection||"")+"</li><li>学历层次："+(t.educatLevel||"")+"</li><li>院校特征："+(t.property||"")+"</li><li>院校类型："+(t.universityType||"")+'</li><li class="'+r+'">院校网址：<a class="website" target="_blank" href="'+t.url+'">'+(t.url||"")+'</a></li><li class="'+i+'">'+e+'</li><li class="'+s+'">联系电话：<span>'+(t.contactPhone||"")+"</span></li></ul></div>")},getIsCollect:function(t){n.get("/userCollection/isUniversityCollect.do?universityId="+t,function(e){if(e.rtnCode="0000000"){var a=e.bizData;0==a?n("#collect").removeClass("active").find("span").text("收藏"):n("#collect").addClass("active").find("span").text("取消收藏"),n("#info_content").on("click","#collect",function(){"收藏"==n("#collect").find("span").text()?l.saveUserCollect(t):l.deleteUserCollect(t)})}})},saveUserCollect:function(t){n.get("/userCollection/saveUserCollect.do?universityId="+t,function(t){"0000000"==t.rtnCode&&n("#collect").addClass("active").find("span").text("取消收藏")})},deleteUserCollect:function(t){n.get("/userCollection/deleteUserCollect.do?universityId="+t,function(t){"0000000"==t.rtnCode&&n("#collect").removeClass("active").find("span").text("收藏")})},schoolIntro:function(t){n.get("/university/getUniversityIntro.do?universityId="+t,function(t){"0000000"==t.rtnCode&&n("#tabs-content1").html(t.bizData.universityIntro).attr("flag",!0)})},brochures:function(t){n.get("/university/getEntroIntro.do?universityId="+t,function(t){"0000000"==t.rtnCode&&n("#tabs-content2").html(t.bizData.entroIntro).attr("flag",!0)})},getSchoolInfo:function(t){var e=this;n.get(" /university/getEnrollInfo.do?id="+t,function(t){console.log(t),"0000000"==t.rtnCode&&e.renderSchool(t.bizData.enrollInfo)})},renderSchool:function(t){for(var e='<div id="tabs_list_last3" class="tabs-ui"><ul>',a="",i=0;i<t.length;i++){var l=t[i].title;e+="<li>"+l+"</li>",a+='<div class="school-table mt20"><table border="0" cellpadding="0" cellspacing="0"><thead><tr><th></th><th>批次</th><th>计划数</th><th>录取数</th><th>最高分</th><th>最高位次</th><th>最低分</th><th>最低位次</th><th>平均分</th><th>平均分位次</th></tr></thead><tbody>';for(var s=0;s<t[i].infos.length;s++){var o=t[i].infos[s];a+="<tr><td>"+(o.subjectName||"")+"</td><td>"+(o.batch||"")+"</td><td>"+(o.planNumber||"")+"</td><td>"+(o.enrollNumber||"")+"</td><td>"+(o.highestScore||"")+"</td><td>"+(o.highestRank||"")+"</td><td>"+(o.lowestScore||"")+"</td><td>"+(o.lowestRank||"")+"</td><td>"+(o.averageScore||"")+"</td><td>"+(o.averageRank||"")+"</td></tr>"}a+="</tbody></table></div>"}e+="</ul></div>",n("#tabs-content3").attr("flag",!0).append(e).append(a).on("click","li",function(){var t=n(this),e=t.index(),a=t.parents("#tabs-content3");t.addClass("active").siblings().removeClass("active"),a.find(".school-table").hide(),a.find(".school-table:eq("+e+")").show()}),n("#tabs_list_last3").find("li:eq(0)").click()},getEnroll:function(t){var a=this,i=e("batch");n.get("/university/getEnrollPlan.do?id="+t+"&batch="+i,function(t){console.log(t),"0000000"==t.rtnCode&&a.renderEnroll(t.bizData.enrollPlan)})},renderEnroll:function(t){for(var e='<div id="tabs_list_last4" class="tabs-ui"><ul>',a="",i=0;i<t.length;i++){var l=t[i].title;e+="<li>"+l+"</li>",a+='<div class="school-table mt20"><div class="subjectType"><label><input type="radio" name="subject1" id=""/> <span>文史</span></label><label><input type="radio" name="subject1" id=""/> <span>理工</span></label></div><table border="0" cellpadding="0" cellspacing="0"><thead><tr><th  class="name">专业名称</th><th>批次</th><th>科类</th><th>计划人数</th><th>学制</th><th>收费标准</th></tr></thead><tbody>';for(var s=0;s<t[i].planInfos.length;s++){var o=t[i].planInfos[s];a+='<tr batch="'+o.subject+'"><td width="50%"><a target="_blank" href="/consult/profession_detail.jsp?id='+o.majoredId+'">'+(o.majoredName||"")+'</a></td><td width="10%">'+(o.batch||"")+'</td><td width="10%">'+(o.subject||"")+'</td><td width="10%">'+(o.planNumber||"")+'</td><td width="10%">'+(o.schoolLength||"")+'</td><td width="10%">'+(o.feeStandard||"")+"</td></tr>"}a+="</tbody></table></div>"}e+="</ul></div>",n("#tabs-content4").attr("flag",!0).append(e).append(a).on("click","li",function(){var t=n(this),e=t.index(),a=t.parents("#tabs-content4");a.find("tr").show(),a.find("label").removeClass("active").find("input").attr("checked",!1),t.addClass("active").siblings().removeClass("active"),a.find(".school-table").hide(),a.find(".school-table:eq("+e+")").show().find("label").on("click",function(){n(this).addClass("active").siblings().removeClass("active");var t=n(this).find("span").text(),e=n(this).parents(".school-table").find('tr[batch="文史"]'),a=n(this).parents(".school-table").find('tr[batch="理工"]');"文史"==t?(a.hide(),e.show()):(e.hide(),a.show())})}),n("#tabs_list_last4").find("li:eq(0)").click()},admitAMark:function(t){var e=this;n.get("/university/getMajoredScoreLineList.do?universityId="+t,function(t){console.log(t),"0000000"==t.rtnCode&&e.renderAdmitAMark(t.bizData)})},renderAdmitAMark:function(t){if(console.log(t),"object"==typeof t&&!(t instanceof Array)){var e=!1;for(var a in t){e=!0;break}if(!e){var l='<div class="school-table mt20">'+i("暂无相关数据")+"</div>";return n("#tabs-content5").attr("flag",!0).append(l),!1}}var s='<div id="tabs_list_last5" class="tabs-ui"><ul>',o="";for(var r in t){var d=r;s+="<li>"+d+"</li>",o+='<div class="school-table mt20"><div class="subjectType"><label><input type="radio" name="subject1" id=""/> <span>文史</span></label><label><input type="radio" name="subject1" id=""/> <span>理工</span></label></div><table border="0" cellpadding="0" cellspacing="0"><thead><tr><th>专业名称</th><th>科类</th><th>录取最高分</th><th>录取平均分</th></tr></thead><tbody>';for(var c=0;c<t[r].length;c++){var h=t[r][c];o+='<tr batch="'+h.subject+'"><td><a target="_blank" href="/consult/profession_detail.jsp?id='+h.majoredId+'">'+(h.majoredName||"-")+"</a></td><td>"+(h.subject||"-")+"</td><td>"+h.highestScore+"</td><td>"+h.averageScore+"</td></tr>"}o+="</tbody></table></div>"}s+="</ul></div>",n("#tabs-content5").attr("flag",!0).append(s).append(o).on("click","li",function(){var t=n(this),e=t.index(),a=t.parents("#tabs-content5");a.find("tr").show(),a.find("label").removeClass("active").find("input").attr("checked",!1),t.addClass("active").siblings().removeClass("active"),a.find(".school-table").hide(),a.find(".school-table:eq("+e+")").show().find("label").on("click",function(){n(this).addClass("active").siblings().removeClass("active");var t=n(this).find("span").text(),e=n(this).parents(".school-table").find('tr[batch="文史"]'),a=n(this).parents(".school-table").find('tr[batch="理工"]');console.log(n(this).parents(".school-table").find("tr").html()),"文史"==t?(a.hide(),e.show()):(e.hide(),a.show())})}),n("#tabs_list_last5").find("li:eq(0)").click()},openSpecialty:function(t){n.get("/university/getOpenMajoredPojoList.do?universityId="+t,function(t){console.log(t);var e=t.bizData;if("0000000"==t.rtnCode){var a='<div class="school-table mt20"><div class="tipTxt"><strong>温馨提示：</strong> <i class="star"></i>号表示该专业在该院校招生</div><table border="0" cellpadding="0" cellspacing="0"><thead><tr><th>专业名称</th><th>科类</th><th>薪资排名</th><th>就业率排名</th></tr></thead><tbody>';if(e.length>0){for(var l=0;l<e.length;l++){var s=e[l].employmentRateRank,o=e[l].isEnrol,r=e[l].majoredName,d=e[l].salaryRank,c=e[l].subject,h=e[l].majoredId,b="";b=1==o?'<i class="star"></i>':"",a+="<tr><td>"+b+'<a target="_blank" href="/consult/profession_detail.jsp?id='+h+'">'+r+"</a></td><td>"+(c||"-")+"</td><td>"+d+"</td><td>"+s+"</td></tr>"}a+="</tbody></table></div>",n("#tabs-content6").attr("flag",!0).append(a)}else a+='<tr><td colspan="4">'+i("暂无相关数据")+"</td></tr></table></div>",n("#tabs-content6").attr("flag",!0).append(a)}})}};n(document).ready(function(){var t=e("code"),a=e("id");t?l.getBasicInfo("code",t):a&&l.getBasicInfo("id",a)})});