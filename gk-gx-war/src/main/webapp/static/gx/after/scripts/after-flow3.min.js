define(function(t){var e=t("$");e(function(){function t(t,a,i){t.m_province=a,t.m_specialty_name=i,e.ajax({url:"/guide/school.do",type:"GET",dataType:"JSON",data:t,success:function(t){if("0100006"==t.rtnCode||"1000004"==t.rtnCode||"0100005"==t.rtnCode)return void e(".error-tips").text(t.msg).fadeIn(1e3).fadeOut(1e3);if("0000000"==t.rtnCode){e(".school-list").html("");var a=e.parseJSON(t.bizData),i=a.related.m_batch_id,n=a.related.m_batch,r=a.data.result;0==r.data.length&&(e(".no-school").show(),e(".school-list").hide());var l="";"文史"==a.related.m_kelei?l=0:"理工"==a.related.m_kelei&&(l=1);var o=e("#volunteer-flow3-layer").attr("datatype");e.each(r.data,function(t,a){0==r.data[t].data.length&&(e(".no-school").show(),e(".school-list").hide()),r.data[t].data.length>0&&6>t&&(null!=r.data[t].description&&e("#school-list"+t).append('<div style="color:#c00">'+r.data[t].description+"</div>"),e("#no-school"+t).hide(),e("#school-list"+t).show(),e.each(r.data[t].data,function(a,r){var s='<div><span class="fl"><a target="_blank" href="/consult/school_detail.jsp?id='+r.m_university_code+"&batch="+i+'" id="'+r.m_university_code+'">'+r.m_university_name+'</a></span><span class="fr selSchool" datatypeId="'+o+'" m_university_name="'+r.m_university_name+'" id="'+r.m_university_code+'" type = "'+l+'" m_batch_id="'+i+'" m_batch="'+n+'">选择</span></div>';e("#school-list"+t).append(s)}))})}}})}function a(t){e('input[name="isFun'+t+'"]').on("click",function(){e(this).hasClass("partChecked")?(e("#specialtyPart"+t).show(),e("#area-tips"+t).hide()):(e("#specialtyPart"+t).hide(),e("#area-tips"+t).show())})}var i=JSON.parse(params);e(".volunteer-flow3-table").on("click",".open-flow3",function(){e(".tansLayer,.volunteer-flow3-layer").show(),e("#volunteer-flow3-layer").attr("dataType",e(this).attr("dataType")),t(i,"","")}),e("#volunteer-flow3-layer").on("click",".close-btn",function(){e("#volunteer-flow3-layer,.tansLayer").hide()}),e.get("/region/getAllRegion.do",function(t){var a=t.bizData;"0000000"===t.rtnCode&&e.each(a,function(t,a){var i=a.name.replace(/[省,市,自治区]/g,"");e("#province-list").append('<option value="'+i+'">'+i+"</option>")})}),e("#specialty-search-btn").on("click",function(){var a=e("#specialty-input").val().trim(),n=e("#province-list option:selected").val();t(i,n,a)}),e("#volunteer-flow3-layer").on("click",".selSchool",function(){var t=e(this).attr("id"),a=e(this).attr("type"),i=e(this).attr("m_batch"),n=e(this).attr("m_batch_id"),r=e(this).attr("datatypeid"),l=e(this).attr("m_university_name"),o=2014,s="",c=e(this).parents(".school-list").attr("dataType");s="A"==c?"★":"B"==c?"★★":"C"==c?"★★★":"★★★★",e.ajax({url:"/university/universityDetail.do",type:"GET",dataType:"JSON",data:{code:t,type:a,year:o,batch:i},success:function(a){var c=a.bizData;if("0000000"===a.rtnCode){var p="<p>";c.dictName&&(p+="院校特征："+c.dictName+"<br/>"),p+="院校隶属："+c.subjection+"<br/>院校类型："+c.type+"<br/>2014年最低投档分："+c.lowestScore+"<br/>2014年最低位次："+c.lowestRanking+" <br/>2014年录取平均分："+c.averageScore+" <br/>2014年平均分位次："+c.averageScoresRanking+" <br/>历年招生情况："+c.enrollIntro+" <br/>录取指数："+s+"</p>",e('.open-flow3[type="text"][dataType="'+r+'"]').val(l).attr({code:t,m_batch:i,m_batch_id:n}),"广西"==c.provinceName?(e('input.partChecked[name="isFun'+r+'"]').parent().show(),e("#area-tips"+r).show()):(e('input.partChecked[name="isFun'+r+'"]').parent().hide(),e("#area-tips"+r).hide()),e("#result-info"+r).html(p),e("#tips"+r).hide(),e("#volunteer-flow3-layer,.tansLayer").hide(),e("#specialty"+r).show().attr({m_batch:i,code:t,year:o}).find("input").val(""),e("#specialtyPart"+r).attr({m_batch:i,code:t,year:o}).find("input").val("")}}})}),a(1),a(2),a(3),a(4),a(5),a(6),e(".specialty").on("click",".specialty-click",function(){var t=e(this).parents(".specialty").attr("id"),a=e(this).parents("li").index(),i=e(this).parents(".specialty"),n=i.attr("m_batch"),r=i.attr("code"),l=i.attr("year");e("#specialty-layer,.tansLayer").show(),e.ajax({url:"/majored/majorList.do",type:"GET",dataType:"JSON",data:{code:r,year:l,batch:n},success:function(i){var r=i.bizData;"0000000"===i.rtnCode&&(e("#specialty-content").html(""),e.each(r,function(i,l){var o=r.length,s=l.name,c=l.subject,p=l.schoolLength,d=l.feeStandard,u=l.planNum,h=(l.id,'<tr><td class="tl"><label id="'+t+'" name="'+s+'" index="'+a+'" specialtyTotal="'+o+'"><input type="radio" name="schoolType" id=""/> '+s+"</label></td><td>"+n+"</td><td>"+c+"</td><td>"+u+"</td><td>"+p+"</td><td>"+d+"</td></tr>");e("#specialty-content").append(h)}))}})}),e("#specialty-layer").on("click","label",function(){var t=e(this).attr("id"),a=e(this).attr("index"),i=e(this).attr("name"),n=e(this).attr("specialtyTotal");e("#"+t+" li:eq("+a+")").find("input").val(i).attr({specialtyTotalN:n}).addClass("write"),e("#specialty-layer,.tansLayer").hide()}),e("#specialty-layer").on("click",".close-btn",function(){e("#specialty-layer,.tansLayer").hide()}),e("#volunteer-flow3-btn").on("click",function(){function t(t){e("#specialty-list-info"+t).html(""),e("#partSel"+t).html(""),e.each(e("#specialty"+t).find("input"),function(a,i){var n="<p>"+(a+1)+"."+e(i).val()+"</p>";e("#specialty-list-info"+t).append(n)}),e.each(e("#specialtyPart"+t).find("input"),function(a,i){var n="<p>"+(a+1)+"."+e(i).val()+"</p>";e("#partSel"+t).append(n)}),e.each(e("#specialty"+t),function(t,a){var i=(e(this).find("input").attr("specialtytotaln"),e(this).find("input.write").length),n="";n+=6>i?'<div class="col-list col-list2">志愿专业填写不完整</div>':'<div class="col-list col-list2">志愿专业填写完整</div>',e("#integrity").append(n)})}if(e(".school-list-col,.enrollmentSchool,#exchange,#integrity,#eva,#enrollment").html(""),""==e("#result-info1").text())return e(".error-tips2").text("请在A志愿中选择学校").fadeIn(1e3).fadeOut(1e3),!1;if(""==e("#result-info2").text())return e(".error-tips2").text("请在B志愿中选择学校").fadeIn(1e3).fadeOut(1e3),!1;if(""==e("#result-info3").text())return e(".error-tips2").text("请在C志愿中选择学校").fadeIn(1e3).fadeOut(1e3),!1;if(""==e("#result-info4").text())return e(".error-tips2").text("请在D志愿中选择学校").fadeIn(1e3).fadeOut(1e3),!1;if(""==e("#result-info5").text())return e(".error-tips2").text("请在E志愿中选择学校").fadeIn(1e3).fadeOut(1e3),!1;if(""==e("#result-info6").text())return e(".error-tips2").text("请在F志愿中选择学校").fadeIn(1e3).fadeOut(1e3),!1;e("#main1").hide(),e("#main2").show(),e("#print-result-info1").html(e("#result-info1").html()).prepend("<p>"+e('input[type="text"][dataType="1"]').val()+"</p>"),e("#print-result-info2").html(e("#result-info2").html()).prepend("<p>"+e('input[type="text"][dataType="2"]').val()+"</p>"),e("#print-result-info3").html(e("#result-info3").html()).prepend("<p>"+e('input[type="text"][dataType="3"]').val()+"</p>"),e("#print-result-info4").html(e("#result-info4").html()).prepend("<p>"+e('input[type="text"][dataType="4"]').val()+"</p>"),e("#print-result-info5").html(e("#result-info5").html()).prepend("<p>"+e('input[type="text"][dataType="5"]').val()+"</p>"),e("#print-result-info6").html(e("#result-info6").html()).prepend("<p>"+e('input[type="text"][dataType="6"]').val()+"</p>"),t(1),t(2),t(3),t(4),t(5),t(6);var a=e('input[name="isFun1"]:checked').val();e("#isFunRadio1").html(a);var n=e('input[name="isFun2"]:checked').val();e("#isFunRadio2").html(n);var r=e('input[name="isFun3"]:checked').val();e("#isFunRadio3").html(r);var l=e('input[name="isFun4"]:checked').val();e("#isFunRadio4").html(l);var o=e('input[name="isFun5"]:checked').val();e("#isFunRadio5").html(o);var s=e('input[name="isFun6"]:checked').val();e("#isFunRadio6").html(s);var c=e('input[type="text"][dataType="1"]').attr("code"),p=e('input[type="text"][dataType="1"]').val(),d=e('input[type="text"][dataType="2"]').attr("code"),u=e('input[type="text"][dataType="2"]').val(),h=e('input[type="text"][dataType="3"]').attr("code"),y=e('input[type="text"][dataType="3"]').val(),m=e('input[type="text"][dataType="4"]').attr("code"),v=e('input[type="text"][dataType="4"]').val(),f=e('input[type="text"][dataType="5"]').attr("code"),_=e('input[type="text"][dataType="5"]').val(),x=e('input[type="text"][dataType="6"]').attr("code"),b=e('input[type="text"][dataType="6"]').val(),g=e('input[type="text"][dataType="1"]').attr("m_batch"),T=e('input[type="text"][dataType="1"]').attr("m_batch_id"),k=[{sequence:1,m_university_code:c,m_university_name:p},{sequence:2,m_university_code:d,m_university_name:u},{sequence:3,m_university_code:h,m_university_name:y},{sequence:4,m_university_code:m,m_university_name:v},{sequence:5,m_university_code:f,m_university_name:_},{sequence:6,m_university_code:x,m_university_name:b}],w={m_batch_id:T,m_batch:g},S="",O=i.m_kelei;S="文史"==O?0:1;var g=i.m_batch,L={data:k,related:w};e.ajax({url:"/guide/report.do",type:"GET",dataType:"JSON",data:{params:JSON.stringify(L),type:S,year:2014,batch:g},success:function(t){if(console.log(e.parseJSON(t.bizData)),e("#enrollment").html(""),"0000000"==t.rtnCode){var a=e.parseJSON(t.bizData).report,i=a.result,n=i[1].description,r=i[2].description,l=i[3].description;e("#eva").text(n.substr(0,n.length-1)),e("#eva-txt").html(r+l),e.each(a.data,function(t,a){var i='<div class="col-list">'+a.m_university_name+"</div>";e(".school-list-col").append(i)});var o=e.parseJSON(t.bizData).enroll;e.each(o,function(t,a){var i=a.enrollIntro,n=a.name,r='<div class="col-list">'+n+"</div>";e("#enrollmentSchool").append(r);var l='<div class="col-list col-list2">'+i+"</div>";e("#enrollment").append(l)})}}}),e.each(e(".isFunRadio"),function(t,a){var i="",n=e(a).text();i+="是"==n?"志愿专业服从调剂":"志愿专业不服从调剂";var r='<div class="col-list col-list2">'+i+"</div>";e("#exchange").append(r)});var N=e("#exchange").find(".col-list").length;e("#exchange").find(".obey").length==N?(e("#noObey").hide(),e("#allObey").show()):(e("#noObey").show(),e("#allObey").hide())}),e("#prev-btn").on("click",function(){e("#main1").show(),e("#main2").hide()}),e.get("/info/getUserInfo.do",function(t){if("0000000"==t.rtnCode){var a=t.bizData,n=a.schoolName,r=a.sex;e("#m_candidateNumber").text(i.m_candidateNumber),e("#m_aggregateScore").text(i.m_aggregateScore),e("#m_ranking").text(i.m_ranking),e("#m_kelei").text(i.m_kelei);var l=i.m_aggregateScore,o="";o="1"==r?"男":"女";var s=i.m_kelei;"文史"==s?l>=530?(e("#controlLine").text("530"),e("#controlLine-txt").text("一批本科省控线")):l>=380&&530>l?(e("#controlLine").text("380"),e("#controlLine-txt").text("二批本科省控线")):(e("#controlLine").text("180"),e("#controlLine-txt").text("高专高职省控线")):"理工"==s&&(l>=480?(e("#controlLine").text("480"),e("#controlLine-txt").text("一批本科省控线")):l>=320&&480>l?(e("#controlLine").text("320"),e("#controlLine-txt").text("二批本科省控线")):(e("#controlLine").text("180"),e("#controlLine-txt").text("高专高职省控线"))),e("#schoolName").text(n),e("#sexT").text(o)}}),e("#print-btn").on("click",function(){window.print()})})});