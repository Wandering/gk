define(function(t){var e=t("$");e(function(){function t(t,a,n){t.m_province=a,t.m_specialty_name=n,e.ajax({url:"/guide/school.do",type:"GET",dataType:"JSON",data:t,success:function(t){if("0100006"==t.rtnCode||"1000004"==t.rtnCode||"0100005"==t.rtnCode)return void e(".error-tips").text(t.msg).fadeIn(1e3).fadeOut(1e3);if("0000000"==t.rtnCode){e(".school-list").html("");var a=e.parseJSON(t.bizData),n=a.related.m_batch_id,i=a.related.m_batch,r=a.data.result;0==r.data.length&&(e(".no-school").show(),e(".school-list").hide());var l="";"文史"==a.related.m_kelei?l=0:"理工"==a.related.m_kelei&&(l=1);var o=e("#volunteer-flow3-layer").attr("datatype");e.each(r.data,function(t,a){0==r.data[t].data.length&&(e(".no-school").show(),e(".school-list").hide()),r.data[t].data.length>0&&6>t&&(null!=r.data[t].description&&e("#school-list"+t).append('<div style="color:#c00">'+r.data[t].description+"</div>"),e("#no-school"+t).hide(),e("#school-list"+t).show(),e.each(r.data[t].data,function(a,r){var s='<div><span class="fl"><a target="_blank" href="/consult/school_detail.jsp?code='+r.m_university_code+"&batch="+n+'" id="'+r.m_university_code+'">'+r.m_university_name+'</a></span><span class="fr selSchool" datatypeId="'+o+'" m_university_name="'+r.m_university_name+'" id="'+r.m_university_code+'" type = "'+l+'" m_batch_id="'+n+'" m_batch="'+i+'">选择</span></div>';e("#school-list"+t).append(s)}))})}}})}function a(t){e('input[name="isFun'+t+'"]').on("click",function(){e(this).hasClass("partChecked")?(e("#specialtyPart"+t).show(),e("#area-tips"+t).hide()):(e("#specialtyPart"+t).hide(),e("#area-tips"+t).show())})}var n=JSON.parse(params);e(".volunteer-flow3-table").on("click",".open-flow3",function(){e(".tansLayer,.volunteer-flow3-layer").show(),e("#volunteer-flow3-layer").attr("dataType",e(this).attr("dataType")),t(n,"","")}),e("#volunteer-flow3-layer").on("click",".close-btn",function(){e("#volunteer-flow3-layer,.tansLayer").hide()}),e.get("/region/getAllRegion.do",function(t){var a=t.bizData;"0000000"===t.rtnCode&&e.each(a,function(t,a){var n=a.name.replace(/[省,市,自治区]/g,"");e("#province-list").append('<option value="'+n+'">'+n+"</option>")})}),e("#specialty-search-btn").on("click",function(){var a=e("#specialty-input").val().trim(),i=e("#province-list option:selected").val();t(n,i,a)}),e("#volunteer-flow3-layer").on("click",".selSchool",function(){var t=e(this).attr("id"),a=e(this).attr("type"),n=e(this).attr("m_batch"),i=e(this).attr("m_batch_id"),r=e(this).attr("datatypeid"),l=e(this).attr("m_university_name"),o=2014,s="",c="",p=e(this).parents(".school-list").attr("dataType");"A"==p?(s="★",c="1"):"B"==p?(s="★★",c="2"):"C"==p?(s="★★",c="3"):"D"==p?(s="★★★",c="4"):"E"==p?(s="★★★",c="5"):(s="★★★★",c="6"),e.ajax({url:"/university/universityDetail.do",type:"GET",dataType:"JSON",data:{code:t,type:a,year:o,batch:n},success:function(a){var p=a.bizData;if("0000000"===a.rtnCode){var d="<p>";p.dictName&&(d+="院校特征："+p.dictName+"<br/>"),d+="院校隶属："+p.subjection+"<br/>院校类型："+p.type+"<br/>2014年最低投档分："+p.lowestScore+"<br/>2014年最低位次："+p.lowestRanking+" <br/>2014年录取平均分："+p.averageScore+" <br/>2014年平均分位次："+p.averageScoresRanking+" <br/>历年招生情况："+p.enrollIntro+" <br/>录取指数："+s+"</p>",e('.open-flow3[type="text"][dataType="'+r+'"]').val(l).attr({code:t,m_batch:n,m_batch_id:i,sequence:c}),"广西"==p.provinceName.substr(0,2)?(e('input.partChecked[name="isFun'+r+'"]').parent().show(),e("#area-tips"+r).show()):(e('input.partChecked[name="isFun'+r+'"]').parent().hide(),e("#area-tips"+r).hide(),e("#specialtyPart"+r).hide()),e("#result-info"+r).html(d),e("#tips"+r).hide(),e("#volunteer-flow3-layer,.tansLayer").hide(),e("#specialty"+r).show().attr({m_batch:n,code:t,year:o}).find("input").val(""),e("#specialtyPart"+r).attr({m_batch:n,code:t,year:o}).find("input").val("")}}})}),a(1),a(2),a(3),a(4),a(5),a(6),e(".specialty").on("click",".specialty-click",function(){var t=e(this).parents(".specialty").attr("id"),a=e(this).parents("li").index(),n=e(this).parents(".specialty"),i=n.attr("m_batch"),r=n.attr("code"),l=n.attr("year");e("#specialty-layer,.tansLayer").show(),e.ajax({url:"/majored/majorList.do",type:"GET",dataType:"JSON",data:{code:r,year:l,batch:i},success:function(n){var r=n.bizData;"0000000"===n.rtnCode&&(e("#specialty-content").html(""),e.each(r,function(n,l){var o=r.length,s=l.name,c=l.subject,p=l.schoolLength,d=l.feeStandard,u=l.planNum,y=(l.id,'<tr><td class="tl"><label id="'+t+'" name="'+s+'" index="'+a+'" specialtyTotal="'+o+'"><input type="radio" name="schoolType" id=""/> '+s+"</label></td><td>"+i+"</td><td>"+c+"</td><td>"+u+"</td><td>"+p+"</td><td>"+d+"</td></tr>");e("#specialty-content").append(y)}))}})}),e("#specialty-layer").on("click","label",function(){var t=e(this).attr("id"),a=e(this).attr("index"),n=e(this).attr("name"),i=e(this).attr("specialtyTotal");e("#"+t+" li:eq("+a+")").find("input").val(n).attr({specialtyTotalN:i}).addClass("write"),e("#specialty-layer,.tansLayer").hide()}),e("#specialty-layer").on("click",".close-btn",function(){e("#specialty-layer,.tansLayer").hide()}),e("#volunteer-flow3-btn").on("click",function(){function t(t){e("#specialty-list-info"+t).html(""),e("#partSel"+t).html(""),e.each(e("#specialty"+t).find("input"),function(a,n){var i="<p>"+(a+1)+"."+e(n).val()+"</p>";e("#specialty-list-info"+t).append(i)}),e.each(e("#specialtyPart"+t).find("input"),function(a,n){var i="<p>"+(a+1)+"."+e(n).val()+"</p>";e("#partSel"+t).append(i)}),e.each(e("#specialty"+t),function(t,a){var n=(e(this).find("input").attr("specialtytotaln"),e(this).find("input.write").length),i="";i+=6>n?'<div class="col-list col-list2">志愿专业填写不完整</div>':'<div class="col-list col-list2">志愿专业填写完整</div>',e("#integrity").append(i)})}if(e(".school-list-col,.enrollmentSchool,#exchange,#integrity,#eva,#enrollment").html(""),""==e("#result-info1").text())return e(".error-tips2").text("请在A志愿中选择学校").fadeIn(1e3).fadeOut(1e3),!1;if(""==e("#result-info2").text())return e(".error-tips2").text("请在B志愿中选择学校").fadeIn(1e3).fadeOut(1e3),!1;if(""==e("#result-info3").text())return e(".error-tips2").text("请在C志愿中选择学校").fadeIn(1e3).fadeOut(1e3),!1;if(""==e("#result-info4").text())return e(".error-tips2").text("请在D志愿中选择学校").fadeIn(1e3).fadeOut(1e3),!1;if(""==e("#result-info5").text())return e(".error-tips2").text("请在E志愿中选择学校").fadeIn(1e3).fadeOut(1e3),!1;if(""==e("#result-info6").text())return e(".error-tips2").text("请在F志愿中选择学校").fadeIn(1e3).fadeOut(1e3),!1;e("#main1").hide(),e("#main2").show(),e("#print-result-info1").html(e("#result-info1").html()).prepend("<p>"+e('input[type="text"][dataType="1"]').val()+"</p>"),e("#print-result-info2").html(e("#result-info2").html()).prepend("<p>"+e('input[type="text"][dataType="2"]').val()+"</p>"),e("#print-result-info3").html(e("#result-info3").html()).prepend("<p>"+e('input[type="text"][dataType="3"]').val()+"</p>"),e("#print-result-info4").html(e("#result-info4").html()).prepend("<p>"+e('input[type="text"][dataType="4"]').val()+"</p>"),e("#print-result-info5").html(e("#result-info5").html()).prepend("<p>"+e('input[type="text"][dataType="5"]').val()+"</p>"),e("#print-result-info6").html(e("#result-info6").html()).prepend("<p>"+e('input[type="text"][dataType="6"]').val()+"</p>"),t(1),t(2),t(3),t(4),t(5),t(6);var a=e('input[name="isFun1"]:checked').val();e("#isFunRadio1").html(a);var i=e('input[name="isFun2"]:checked').val();e("#isFunRadio2").html(i);var r=e('input[name="isFun3"]:checked').val();e("#isFunRadio3").html(r);var l=e('input[name="isFun4"]:checked').val();e("#isFunRadio4").html(l);var o=e('input[name="isFun5"]:checked').val();e("#isFunRadio5").html(o);var s=e('input[name="isFun6"]:checked').val();e("#isFunRadio6").html(s);var c=e('input[type="text"][dataType="1"]').attr("code"),p=e('input[type="text"][dataType="1"]').val(),d=e('input[type="text"][dataType="1"]').attr("sequence"),u=e('input[type="text"][dataType="2"]').attr("code"),y=e('input[type="text"][dataType="2"]').val(),h=e('input[type="text"][dataType="2"]').attr("sequence"),m=e('input[type="text"][dataType="3"]').attr("code"),v=e('input[type="text"][dataType="3"]').val(),f=e('input[type="text"][dataType="3"]').attr("sequence"),x=e('input[type="text"][dataType="4"]').attr("code"),_=e('input[type="text"][dataType="4"]').val(),b=e('input[type="text"][dataType="4"]').attr("sequence"),g=e('input[type="text"][dataType="5"]').attr("code"),T=e('input[type="text"][dataType="5"]').val(),k=e('input[type="text"][dataType="5"]').attr("sequence"),w=e('input[type="text"][dataType="6"]').attr("code"),S=e('input[type="text"][dataType="6"]').val(),O=e('input[type="text"][dataType="6"]').attr("sequence"),L=e('input[type="text"][dataType="1"]').attr("m_batch"),N=e('input[type="text"][dataType="1"]').attr("m_batch_id"),F=[{sequence:d,m_university_code:c,m_university_name:p},{sequence:h,m_university_code:u,m_university_name:y},{sequence:f,m_university_code:m,m_university_name:v},{sequence:b,m_university_code:x,m_university_name:_},{sequence:k,m_university_code:g,m_university_name:T},{sequence:O,m_university_code:w,m_university_name:S}],C={m_batch_id:N,m_batch:L},q="",D=n.m_kelei;q="文史"==D?0:1;var L=n.m_batch,I={data:F,related:C};e.ajax({url:"/guide/report.do",type:"GET",dataType:"JSON",data:{params:JSON.stringify(I),type:q,year:2014,batch:L},success:function(t){if(console.log(e.parseJSON(t.bizData)),e("#enrollment").html(""),"0000000"==t.rtnCode){var a=e.parseJSON(t.bizData).report,n=a.result,i=n[1].description,r=n[2].description,l=n[3].description;e("#eva").text(i.substr(0,i.length-1)),e("#eva-txt").html(r+l),e.each(a.data,function(t,a){var n='<div class="col-list">'+a.m_university_name+"</div>";e(".school-list-col").append(n)});var o=e.parseJSON(t.bizData).enroll;e.each(o,function(t,a){var n=a.enrollIntro,i=a.name,r='<div class="col-list">'+i+"</div>";e("#enrollmentSchool").append(r);var l='<div class="col-list col-list2">'+n+"</div>";e("#enrollment").append(l)})}}}),e.each(e(".isFunRadio"),function(t,a){var n="",i=e(a).text();n+="是"==i?"志愿专业服从调剂":"志愿专业不服从调剂";var r='<div class="col-list col-list2">'+n+"</div>";e("#exchange").append(r)});var J=e("#exchange").find(".col-list").length;e("#exchange").find(".obey").length==J?(e("#noObey").hide(),e("#allObey").show()):(e("#noObey").show(),e("#allObey").hide())}),e("#prev-btn").on("click",function(){e("#main1").show(),e("#main2").hide()}),e.get("/info/getUserInfo.do",function(t){if(console.log(t),"0000000"==t.rtnCode){var a=t.bizData,i=a.schoolName,r=a.sex,l=a.name;e("#studentName").text(l),e("#m_candidateNumber").text(n.m_candidateNumber),e("#m_aggregateScore").text(n.m_aggregateScore),e("#m_ranking").text(n.m_ranking),e("#m_kelei").text(n.m_kelei);var o=n.m_aggregateScore,s="";s="1"==r?"男":"女";var c=n.m_kelei;"文史"==c?o>=530?(e("#controlLine").text("530"),e("#controlLine-txt").text("一批本科省控线")):o>=380&&530>o?(e("#controlLine").text("380"),e("#controlLine-txt").text("二批本科省控线")):(e("#controlLine").text("180"),e("#controlLine-txt").text("高专高职省控线")):"理工"==c&&(o>=480?(e("#controlLine").text("480"),e("#controlLine-txt").text("一批本科省控线")):o>=320&&480>o?(e("#controlLine").text("320"),e("#controlLine-txt").text("二批本科省控线")):(e("#controlLine").text("180"),e("#controlLine-txt").text("高专高职省控线"))),e("#schoolName").text(i),e("#sexT").text(s)}}),e("#print-btn").on("click",function(){window.print()})})});