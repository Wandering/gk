<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="cn.thinkjoy.gk.dao.information.ex.IExpertOrderExDAO">
<!--
insert
update
updateNull
deleteById
deleteByCondition
deleteByProperty
fetch
findOne
findList
findAll
queryPage
like
queryList
queryOne
count
selectMaxId
updateOrSave
selectOne
selectList
-->
    <sql id="Base_Column_List">
        ord.id as id,
        ord.card_id as cardId,
        ord.service_item as serviceItem,
        ord.user_id as userId,
        ord.expert_id as expertId,
        ord.channel as channel,
        ord.channel_num as channelNum,
        ord.contact_person as contactPerson,
        ord.contact_phone as contactPhone,
        ord.expect_time as expectTime,
        ord.end_time as endTime,
        ord.question_desc as questionDesc,
        ord.agree_mark as agreeMark,
        ord.status as status,
        ord.score as score,
        ord.comments as comments,
        ord.create_date as createDate,
        ord.service_count as serviceCount,
        config.serviceType as serviceName,
        info.expert_name as expertName
    </sql>

    <select id="findOne" parameterType="java.util.Map" resultType="ExpertReservationOrderDetailDTO">
        SELECT
        <include refid="Base_Column_List" />
        FROM zgk_expert_reservation_order_detail ord WHERE
        ${property} = #{value}
        LIMIT 0,1
    </select>

    <select id="findList" parameterType="java.util.Map" resultType="ExpertReservationOrderDetailDTO">
        SELECT
        <include refid="Base_Column_List" />
        FROM zgk_expert_reservation_order_detail ord
        LEFT JOIN zgk_expert_info info on ord.expert_id =info.id
        INNER JOIN zgk_card card on ord.card_id = card.id
        Left join zgk_expert_product_service config on config.serviceId =  ord.service_item
        and config.productId = card.productType
        AND config.areaId = #{areaId}
        WHERE
        ${property} = #{value}
        <if test="orderBy!=null">
            ORDER BY ${orderBy} ${sortBy}
        </if>
    </select>

    <select id="findAll" resultType="ExpertReservationOrderDetailDTO">
        SELECT
        <include refid="Base_Column_List" />
        FROM zgk_expert_reservation_order_detail ord
        <if test="orderBy!=null">
            ORDER BY ${orderBy} ${sortBy}
        </if>
    </select>



    <select id="queryList" parameterType="java.util.Map" resultType="ExpertReservationOrderDetailDTO">
        SELECT
        <include refid="Base_Column_List" />
        FROM zgk_expert_reservation_order_detail ord
        LEFT JOIN zgk_expert_info info on ord.expert_id =info.id
        INNER JOIN zgk_card card on ord.card_id = card.id
        Left join zgk_expert_product_service config on config.serviceId =  ord.service_item
        and config.productId = card.productType
        AND config.areaId = #{condition.areaId}
        <trim prefix="WHERE" prefixOverrides="AND | OR">
            <if test="condition.id!=null">
                AND ord.id = #{condition.id}
            </if>
            <if test="condition.cardId!=null">
                AND ord.card_id = #{condition.cardId}
            </if>
            <if test="condition.serviceItem!=null">
                AND ord.service_item = #{condition.serviceItem}
            </if>
            <if test="condition.userId!=null">
                AND ord.user_id = #{condition.userId}
            </if>
            <if test="condition.expertId!=null">
                AND ord.expert_id = #{condition.expertId}
            </if>
            <if test="condition.channel!=null">
                AND ord.channel = #{condition.channel}
            </if>
            <if test="condition.channelNum!=null">
                AND ord.channel_num = #{condition.channelNum}
            </if>
            <if test="condition.contactPerson!=null">
                AND ord.contact_person = #{condition.contactPerson}
            </if>
            <if test="condition.contactPhone!=null">
                AND ord.contact_phone = #{condition.contactPhone}
            </if>
            <if test="condition.expectTime!=null">
                AND ord.expect_time = #{condition.expectTime}
            </if>
            <if test="condition.endTime!=null">
                AND ord.end_time = #{condition.endTime}
            </if>
            <if test="condition.questionDesc!=null">
                AND ord.question_desc = #{condition.questionDesc}
            </if>
            <if test="condition.agreeMark!=null">
                AND ord.agree_mark = #{condition.agreeMark}
            </if>
            <if test="condition.status!=null">
                AND ord.status = #{condition.status}
            </if>
            <if test="condition.score!=null">
                AND ord.score = #{condition.score}
            </if>
            <if test="condition.comments!=null">
                AND ord.comments = #{condition.comments}
            </if>
            <if test="condition.createDate!=null">
                AND ord.create_date = #{condition.createDate}
            </if>
            <if test="condition.serviceCount!=null">
                AND ord.service_count = #{condition.serviceCount}
            </if>
        </trim>
        <if test="orderBy!=null">
        ORDER BY ${orderBy} ${sortBy}
        </if>
    </select>

    <select id="queryOne" parameterType="java.util.Map" resultType="ExpertReservationOrderDetailDTO">
        SELECT
        <include refid="Base_Column_List" />
        FROM zgk_expert_reservation_order_detail ord
        LEFT JOIN zgk_expert_info info on ord.expert_id =info.id
        INNER JOIN zgk_card card on ord.card_id = card.id
        Left join zgk_expert_product_service config on config.serviceId =  ord.service_item
        and config.productId = card.productType
        AND config.areaId = #{areaId}
        <trim prefix="WHERE" prefixOverrides="AND | OR">
            <if test="condition.id!=null">
                AND id = #{condition.id}
            </if>
            <if test="condition.cardId!=null">
                AND card_id = #{condition.cardId}
            </if>
            <if test="condition.serviceItem!=null">
                AND service_item = #{condition.serviceItem}
            </if>
            <if test="condition.userId!=null">
                AND user_id = #{condition.userId}
            </if>
            <if test="condition.expertId!=null">
                AND expert_id = #{condition.expertId}
            </if>
            <if test="condition.channel!=null">
                AND channel = #{condition.channel}
            </if>
            <if test="condition.channelNum!=null">
                AND channel_num = #{condition.channelNum}
            </if>
            <if test="condition.contactPerson!=null">
                AND contact_person = #{condition.contactPerson}
            </if>
            <if test="condition.contactPhone!=null">
                AND contact_phone = #{condition.contactPhone}
            </if>
            <if test="condition.expectTime!=null">
                AND expect_time = #{condition.expectTime}
            </if>
            <if test="condition.endTime!=null">
                AND end_time = #{condition.endTime}
            </if>
            <if test="condition.questionDesc!=null">
                AND question_desc = #{condition.questionDesc}
            </if>
            <if test="condition.agreeMark!=null">
                AND agree_mark = #{condition.agreeMark}
            </if>
            <if test="condition.status!=null">
                AND status = #{condition.status}
            </if>
            <if test="condition.score!=null">
                AND score = #{condition.score}
            </if>
            <if test="condition.comments!=null">
                AND comments = #{condition.comments}
            </if>
            <if test="condition.createDate!=null">
                AND create_date = #{condition.createDate}
            </if>
            <if test="condition.serviceCount!=null">
                AND service_count = #{condition.serviceCount}
            </if>
        </trim>
        limit 0,1
    </select>
    <select id="queryPage" resultType="ExpertReservationOrderDetailDTO">
        SELECT
        <include refid="Base_Column_List" />
        FROM zgk_expert_reservation_order_detail ord
        LEFT JOIN zgk_expert_info info on ord.expert_id =info.id
        INNER JOIN zgk_card card on ord.card_id = card.id
        Left join zgk_expert_product_service config on config.serviceId =  ord.service_item
        and config.productId = card.productType
        AND config.areaId = #{condition.areaId}
        <where>

            <if test="condition.whereSql != null">
                and id in (#{condition.whereSql})
            </if>

            <if test="condition.id!=null">
                ${condition.groupOp}   id  ${condition.id.op}  #{condition.id.data}
            </if>
            <if test="condition.cardId!=null">
                ${condition.groupOp}   card_id  ${condition.cardId.op}  #{condition.cardId.data}
            </if>
            <if test="condition.serviceItem!=null">
                ${condition.groupOp}   service_item  ${condition.serviceItem.op}  #{condition.serviceItem.data}
            </if>
            <if test="condition.userId!=null">
                ${condition.groupOp}   user_id  ${condition.userId.op}  #{condition.userId.data}
            </if>
            <if test="condition.expertId!=null">
                ${condition.groupOp}   expert_id  ${condition.expertId.op}  #{condition.expertId.data}
            </if>
            <if test="condition.channel!=null">
                ${condition.groupOp}   channel  ${condition.channel.op}  #{condition.channel.data}
            </if>
            <if test="condition.channelNum!=null">
                ${condition.groupOp}   channel_num  ${condition.channelNum.op}  #{condition.channelNum.data}
            </if>
            <if test="condition.contactPerson!=null">
                ${condition.groupOp}   contact_person  ${condition.contactPerson.op}  #{condition.contactPerson.data}
            </if>
            <if test="condition.contactPhone!=null">
                ${condition.groupOp}   contact_phone  ${condition.contactPhone.op}  #{condition.contactPhone.data}
            </if>
            <if test="condition.expectTime!=null">
                ${condition.groupOp}   expect_time  ${condition.expectTime.op}  #{condition.expectTime.data}
            </if>
            <if test="condition.endTime!=null">
                ${condition.groupOp}   end_time  ${condition.endTime.op}  #{condition.endTime.data}
            </if>
            <if test="condition.questionDesc!=null">
                ${condition.groupOp}   question_desc  ${condition.questionDesc.op}  #{condition.questionDesc.data}
            </if>
            <if test="condition.agreeMark!=null">
                ${condition.groupOp}   agree_mark  ${condition.agreeMark.op}  #{condition.agreeMark.data}
            </if>
            <if test="condition.status!=null">
                ${condition.groupOp}   status  ${condition.status.op}  #{condition.status.data}
            </if>
            <if test="condition.score!=null">
                ${condition.groupOp}   score  ${condition.score.op}  #{condition.score.data}
            </if>
            <if test="condition.comments!=null">
                ${condition.groupOp}   comments  ${condition.comments.op}  #{condition.comments.data}
            </if>
            <if test="condition.createDate!=null">
                ${condition.groupOp}   create_date  ${condition.createDate.op}  #{condition.createDate.data}
            </if>
            <if test="condition.serviceCount!=null">
                ${condition.groupOp}   service_count  ${condition.serviceCount.op}  #{condition.serviceCount.data}
            </if>


        </where>

        <if test="orderBy!=null">
            ORDER BY ${orderBy} ${sortBy}
        </if>
        <if test="offset != null">
            limit ${offset}, ${rows}
        </if>
    </select>

    <select id="count" resultType="java.lang.Integer">
        SELECT count(id) FROM zgk_expert_reservation_order_detail
        <where>
            <if test="id!=null">
                ${groupOp} id ${id.op}  #{id.data}
            </if>
            <if test="cardId!=null">
                ${groupOp} card_id ${cardId.op}  #{cardId.data}
            </if>
            <if test="serviceItem!=null">
                ${groupOp} service_item ${serviceItem.op}  #{serviceItem.data}
            </if>
            <if test="userId!=null">
                ${groupOp} user_id ${userId.op}  #{userId.data}
            </if>
            <if test="expertId!=null">
                ${groupOp} expert_id ${expertId.op}  #{expertId.data}
            </if>
            <if test="channel!=null">
                ${groupOp} channel ${channel.op}  #{channel.data}
            </if>
            <if test="channelNum!=null">
                ${groupOp} channel_num ${channelNum.op}  #{channelNum.data}
            </if>
            <if test="contactPerson!=null">
                ${groupOp} contact_person ${contactPerson.op}  #{contactPerson.data}
            </if>
            <if test="contactPhone!=null">
                ${groupOp} contact_phone ${contactPhone.op}  #{contactPhone.data}
            </if>
            <if test="expectTime!=null">
                ${groupOp} expect_time ${expectTime.op}  #{expectTime.data}
            </if>
            <if test="endTime!=null">
                ${groupOp} end_time ${endTime.op}  #{endTime.data}
            </if>
            <if test="questionDesc!=null">
                ${groupOp} question_desc ${questionDesc.op}  #{questionDesc.data}
            </if>
            <if test="agreeMark!=null">
                ${groupOp} agree_mark ${agreeMark.op}  #{agreeMark.data}
            </if>
            <if test="status!=null">
                ${groupOp} status ${status.op}  #{status.data}
            </if>
            <if test="score!=null">
                ${groupOp} score ${score.op}  #{score.data}
            </if>
            <if test="comments!=null">
                ${groupOp} comments ${comments.op}  #{comments.data}
            </if>
            <if test="createDate!=null">
                ${groupOp} create_date ${createDate.op}  #{createDate.data}
            </if>
            <if test="serviceCount!=null">
                ${groupOp} service_count ${serviceCount.op}  #{serviceCount.data}
            </if>

        </where>
        <if test="orderBy!=null">
            ORDER BY ${orderBy} ${sortBy}
        </if>
    </select>

</mapper>

