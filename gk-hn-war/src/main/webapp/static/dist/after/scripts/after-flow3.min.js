define(function(t){var e=t("$");e(function(){function t(t,a,o){t.m_province=a,t.m_specialty_name=o,e.ajax({url:"/guide/school.do",type:"GET",dataType:"JSON",data:t,success:function(t){if("0100006"==t.rtnCode||"1000004"==t.rtnCode||"0100005"==t.rtnCode)return void e(".error-tips").text(t.msg).fadeIn(1e3).fadeOut(1e3);if("0000000"==t.rtnCode){var a=e.parseJSON(t.bizData),o=a.related.m_batch_id,i=a.related.m_batch,n=a.data.result;0==n.data.length&&(e(".no-school").show(),e(".school-list").hide());var r="";"文史"==a.related.m_kelei?r=0:"理工"==a.related.m_kelei&&(r=1);var l=e("#volunteer-flow3-layer").attr("datatype");e(".school-list").html(""),e.each(n.data,function(t,a){0==n.data[t].data.length&&(e(".no-school").show(),e(".school-list").hide()),n.data[t].data.length>0&&4>t&&(e("#no-school"+t).hide(),e("#school-list"+t).show(),e.each(n.data[t].data,function(a,n){var c='<div><span class="fl"><a target="_blank" href="/consult/school_detail.jsp?id='+n.m_university_code+"&batch="+o+'" id="'+n.m_university_code+'">'+n.m_university_name+'</a></span><span class="fr selSchool" datatypeId="'+l+'" m_university_name="'+n.m_university_name+'" id="'+n.m_university_code+'" type = "'+r+'" m_batch="'+i+'">选择</span></div>';e("#school-list"+t).append(c)}))})}}})}e(".volunteer-flow3-table").on("click",".open-flow3",function(){e(".tansLayer,.volunteer-flow3-layer").show(),e("#volunteer-flow3-layer").attr("dataType",e(this).attr("dataType")),t(a,"","")}),e("#volunteer-flow3-layer").on("click",".close-btn",function(){e("#volunteer-flow3-layer,.tansLayer").hide()});var a=(JSON.parse(params),{m_candidateNumber:"0",m_aggregateScore:390,m_ranking:72465,m_kelei:"文史",m_batch_id:4,m_batch:"高职（专科）",m_province_id:"0",m_province:"",m_specialty_id:"",m_specialty_name:"",m_favorites_by_university_codes:""});e.get("/region/getAllRegion.do",function(t){var a=t.bizData;"0000000"===t.rtnCode&&e.each(a,function(t,a){var o=a.name.replace(/[省,市,自治区]/g,"");e("#province-list").append('<option value="'+o+'">'+o+"</option>")})}),e("#specialty-search-btn").on("click",function(){var o=e("#specialty-input").val().trim(),i=e("#province-list option:selected").val();t(a,i,o)}),e("#volunteer-flow3-layer").on("click",".selSchool",function(){var t=e(this).attr("id"),a=e(this).attr("type"),o=e(this).attr("m_batch"),i=e(this).attr("datatypeid"),n=e(this).attr("m_university_name"),r=2014,l="",c=e(this).parents(".school-list").attr("dataType");l="A"==c?"★":"B"==c?"★★":"C"==c?"★★★":"★★★★",e.ajax({url:"/university/universityDetail.do",type:"GET",dataType:"JSON",data:{code:t,type:a,year:r,batch:o},success:function(a){console.log(a);var c=a.bizData;if("0000000"===a.rtnCode){var s="";c.dictName&&(s=c.dictName);var d="<p>院校代码："+c.code+"  <br/>院校特征："+s+"<br/>院校隶属："+c.subjection+"<br/>院校类型："+c.type+"<br/>2014年最低投档分："+c.lowestScore+"<br/>2014年最低位次："+c.lowestRanking+" <br/>2014年录取平均分："+c.averageScore+" <br/>2014年平均分位次："+c.averageScoresRanking+" <br/>历年招生情况："+c.enrollIntro+" <br/>录取指数："+l+"</p>";e('.open-flow3[type="text"][dataType="'+i+'"]').val(n),e("#result-info"+i).html(d),e("#specialty"+i).show().attr({m_batch:o,code:t,year:r}),e("#volunteer-flow3-layer,.tansLayer").hide(),e("#tips"+i).hide()}}})}),e(".specialty").on("click",".specialty-click",function(){var t=e(this).parents(".specialty"),a=t.attr("m_batch"),o=t.attr("code"),i=t.attr("year");console.log(a+"="+o+"="+i),e.ajax({url:"/majored/majorList.do",type:"GET",dataType:"JSON",data:{code:o,year:i,batch:a},success:function(t){console.log(t);var o=t.bizData;"0000000"===t.rtnCode&&(e("#specialty-layer,.tansLayer").show(),e.each(o,function(t,o){var i=o.name,n=o.subject,r=o.schoolLength,l=o.feeStandard,c=(o.id,'<tr><td align="left"><input type="radio" name="" id=""/> '+i+"</td><td>"+a+"</td><td>"+n+"</td><td></td><td>"+r+"</td><td>"+l+"</td></tr>");e("#specialty-content").append(c)}))}})}),e("#specialty-layer").on("click",".close-btn",function(){e("#specialty-layer,.tansLayer").hide()})})});